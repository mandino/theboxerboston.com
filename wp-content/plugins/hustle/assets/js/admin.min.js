!function(e){"use strict";window.Hustle=function(e,t,i){var s={},n={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g},a=_.extend({},Backbone.Events),o=Backbone.View.extend({__baseEvents:{"click .wph-tabs--wrap .wph-tabs--nav li label":"__baseToggleTab"},initialize:function(){this.events=_.extend({},this.events,this.__baseEvents),_.isFunction(this.initMix)&&this.initMix.apply(this,arguments),this.render&&(this.render=_.wrap(this.render,function(e){this.trigger("before_render"),e.call(this),a.trigger("view.rendered",this),this.trigger("rendered")})),_.isFunction(this.init)&&this.init.apply(this,arguments)},__baseToggleTab:function(e){var t=this.$(e.target),i=(t.attr("href")||"").replace(/^\#/,""),s=!!i&&this.$("#"+i),n=t.closest(".wph-tabs--wrap"),a=t.closest("li");s&&s.length&&(n.find(".wph-tabs--content").not(s).removeClass("current"),s.addClass("current"),a.addClass("current"),a.siblings().removeClass("current"))}}),l=_.memoize(function(e){var t;return function(i){return(t=t||_.template(document.getElementById(e).innerHTML,null,n))(i).replace("/*<![CDATA[*/","").replace("/*]]>*/","")}}),d=_.memoize(function(e){var t;return function(i){return(t=t||_.template(e,null,n))(i)}});return{define:function(n,a){if(n.split(".").length)!function s(n,o){var l,d=n.split("."),r=d.splice(0,1)[0];r&&(d.length?o[r]=o[r]||{}:(l=a.call(null,e,t,i),o[r]=_.isFunction(l)||void 0===l?l:_.extend(o[r]||{},l)),d.length&&r&&s(d.join("."),o[r]))}(n,s);else{var o=s[n]||{};s[n]=_.extend(o,a.call(null,e,t,i))}},getModules:function(){return s},get:function(e){var t,i;return e.split(".").length?(t=!1,(i=function(e,s){var n=e.split("."),a=n.splice(0,1)[0];t=s[a],n.length&&i(n.join("."),s[a])})(e,s),t):s[e]||!1},Events:a,View:o,template:l,createTemplate:d,getTemplateOptions:function(){return e.extend(!0,{},n)},cookie:{set:function(t,i,s){var n,a;i=e.isArray(i)||e.isPlainObject(i)?JSON.stringify(i):i,isNaN(s)?a="":((n=new Date).setTime(n.getTime()+24*s*60*60*1e3),a="; expires="+n.toGMTString()),document.cookie=t+"="+i+a+"; path=/"},get:function(e){var t,i,s,n=document.cookie.split(";"),a=n.length;for(s=e+"=",t=0;t<a;t+=1){for(i=n[t];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(s)){var o=i.substring(s.length,i.length);return o?JSON.parse(o):o}}return null}},consts:{ModuleShowCount:"hustle_module_show_count-"}}}(jQuery,document,window)}(jQuery),(Optin=Optin||{}).View={},Optin.Models={},Optin.Events={},"undefined"!=typeof Backbone&&_.extend(Optin.Events,Backbone.Events),function(e){"use strict";Optin.NEVER_SEE_PREFIX="inc_optin_never_see_again-",Optin.COOKIE_PREFIX="inc_optin_long_hidden-",Optin.POPUP_COOKIE_PREFIX="inc_optin_popup_long_hidden-",Optin.SLIDE_IN_COOKIE_PREFIX="inc_optin_slide_in_long_hidden-",Optin.EMBEDDED_COOKIE_PREFIX="inc_optin_embedded_long_hidden-",Optin.globalMixin=function(){_.mixin({log:function(){console.log(arguments)},toBool:function(e){return _.isBoolean(e)?e:_.isString(e)&&-1!==["true","false","1"].indexOf(e.toLowerCase())?"true"===e.toLowerCase()||"1"===e.toLowerCase():_.isNumber(e)?!!e:!(_.isUndefined(e)||_.isNull(e)||_.isNaN(e))&&e},isTrue:function(e){return!(_.isUndefined(e)||_.isNull(e)||_.isNaN(e))&&(_.isNumber(e)?0!==e:(e=e.toString().toLowerCase(),-1!==["1","true","on"].indexOf(e)))},isFalse:function(e){return!_.isTrue(e)},controlBase:function(e,t,i){return i=_.isUndefined(i)?"checked":i,e=_.toBool(e),t=_.isBoolean(e)?_.isTrue(t):t,_.isEqual(e,t)?i+"="+i:""},checked:function(e,t){return _.controlBase(e,t,"checked")},selected:function(e,t){return _.controlBase(e,t,"selected")},disabled:function(e,t){return _.controlBase(e,t,"disabled")},class:function(e,t,i){return _.isTrue(e)?t:void 0!==i?i:""},add_class:function(e,t,i){return"class={class}".replace("{class}",_.class(e,t,i))},toUpperCase:function(e){return _.isString(e)?e.toUpperCase():""}}),_.findKey||_.mixin({findKey:function(e,t,i){t=cb(t,i);for(var s,n=_.keys(e),a=0,o=n.length;a<o;a++)if(t(e[s=n[a]],s,e))return s}})},Optin.globalMixin(),Backbone.Model.prototype.toJSON=function(){var e,t=_.clone(this.attributes);for(e in t)(t[e]instanceof Backbone.Model||Backbone.Collection&&t[e]instanceof Backbone.Collection)&&(t[e]=t[e].toJSON());return t},String.prototype.toInt=function(){return parseInt(this,10)},String.prototype.isEmpty=function(){return 0===this.length||!this.trim()},Optin.template=_.memoize(function(t){var i,s={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g};return function(n){return(i=i||_.template(e("#"+t).html(),null,s))(n).replace("/*<![CDATA[*/","").replace("/*]]>*/","")}}),Optin.templateCompat=_.memoize(function(t){var i;return function(s){return(i=i||_.template(e("#"+t).html()))(s).replace("/*<![CDATA[*/","").replace("/*]]>*/","")}}),Optin.cookie=Hustle.cookie,e(document).on("blur",".hustle-modal-optin_form input, .hustle-modal-optin_form textarea, .hustle-modal-optin_form select",function(){var t=e(this);t.is(":input[type=button], :input[type=submit], :input[type=reset]")||(t.val()&&t.val().trim&&""!==t.val().trim()?t.closest(".hustle-modal-optin_field").addClass("hustle-input-filled"):t.closest(".hustle-modal-optin_field").removeClass("hustle-input-filled"))}),Optin.Mixins={_mixins:{},_servicesMixins:{},_desingMixins:{},_displayMixins:{},add:function(e,t){this._mixins[e]=t},getMixins:function(){return this._mixins},addServicesMixin:function(e,t){this._servicesMixins[e]=t},getServicesMixins:function(){return this._servicesMixins}}}(jQuery);var Optin=Optin||{};function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}jQuery,function(e){"use strict";Hustle.Events.on("view.rendered",function(t){t instanceof Backbone.View&&(t.$("select:not([multiple])").each(function(){SUI.suiSelect(this)}),t.$(".sui-select:not(.hustle-select-ajax)").SUIselect2({dropdownCssClass:"sui-select-dropdown"}),t.$(".sui-accordion").each(function(){SUI.suiAccordion(this)}),SUI.suiTabs(),SUI.floatInput(),e(".sui-side-tabs label.sui-tab-item input").each(function(){var t=e(this),i=t.parent("label"),s=t.data("tab-menu"),n=t.closest(".sui-side-tabs"),a=n.find(">.sui-tabs-menu .sui-tab-item"),o=a.find("input");t.on("click",function(e){a.removeClass("active"),o.removeAttr("checked"),n.find(".sui-tabs-content>div[data-tab-content]").removeClass("active"),i.addClass("active"),t.attr("checked","checked");var l=n.find('.sui-tabs-content div[data-tab-content="'+s+'"]');l.length&&l.addClass("active")})}))}),Hustle.Events.on("modules.view.rendered",function(t){Hustle.Events.trigger("modules.view.select.render",t),t instanceof Backbone.View&&(e("#wph-preview-modal").each(function(){var i=e(this),s=i.find(".hustle-modal-success"),n=i.find(".hustle-modal-cta"),a=i.find("a"),o=i.find("button");n.on("click",function(e){e.preventDefault()}),a.on("click",function(e){e.preventDefault()}),s.length?o.on("click",function(e){e.preventDefault(),s.addClass("hustle-modal-success_show"),Hustle.Events.trigger("modules.view.preview.success",t)}):o.on("click",function(e){e.preventDefault()})}),e(".hustle-modal-three .hustle-modal-optin_form").each(function(){var t=e(this),i=t.find(".hustle-modal-optin_field"),s=e('<div class="hustle-modal-optin_half" />'),n=i.length;if(t.hasClass("hustle-modal-optin_groups")){t.find(".hustle-modal-optin_group").addClass("hustle-modal-half_enabled");for(var a=0;a<n;a+=2)i.filter(":eq("+a+"),:eq("+(a+1)+")").wrapAll(s)}}),e(".hustle-modal-four .hustle-modal-optin_form").each(function(){var t=e(this),i=t.find(".hustle-modal-optin_field"),s=e('<div class="hustle-modal-optin_half" />'),n=i.length;if(t.hasClass("hustle-modal-optin_groups")){t.find(".hustle-modal-optin_group").addClass("hustle-modal-half_enabled");for(var a=0;a<n;a+=2)i.filter(":eq("+a+"),:eq("+(a+1)+")").wrapAll(s)}}),console.log("view rendered"))}),e(document).ready(function(){e("#hustle-email-day").length&&e("#hustle-email-day").datepicker({beforeShow:function(t,i){e("#ui-datepicker-div").addClass("sui-calendar")},dateFormat:"MM dd, yy"}),e("#hustle-email-time").length&&e("#hustle-email-time").timepicker({timeFormat:"h:mm p",interval:"1",minTime:"0",maxTime:"11:59pm",defaultTime:null,startTime:"00:00",dynamic:!1,dropdown:!0,scrollbar:!0,change:function(){e("#hustle-email-time").trigger("change")}}),e("#hustle-notice-pro-is-available .notice-dismiss").on("click",function(t){e.post(ajaxurl,{action:"hustle_dismiss_admin_notice",dismissedNotice:"hustle_pro_is_available"},function(e){})}),e(".hustle-copy-shortcode-button").on("click",function(t){t.preventDefault();var i=e(t.target),s=i.data("shortcode"),n=i.closest(".sui-with-button-inside");if(void 0!==s){var a=e("<input />");e("body").append(a),a.val(s).select(),document.execCommand("copy"),a.remove()}else if(n.length){n.find('input[type="text"]').select(),document.execCommand("copy")}}),e("#hustle-tracking-migration-notice .hustle-notice-dismiss").on("click",function(t){t.preventDefault(),e("#hustle-dismiss-modal-button").on("click",function(t){t.preventDefault(),e.post(ajaxurl,{action:"hustle_dismiss_notification",name:e(t.currentTarget).data("name"),_ajax_nonce:e(t.currentTarget).data("nonce")}).always(function(){return location.reload()})}),SUI.dialogs["hustle-dialog--migrate-dismiss-confirmation"].show()}),e(".hustle-notice .notice-dismiss, .hustle-notice .dismiss-notice").on("click",function(t){t.preventDefault();var i=e(t.currentTarget).closest(".hustle-notice");e.post(ajaxurl,{action:"hustle_dismiss_notification",name:i.data("name"),_ajax_nonce:i.data("nonce")}).always(function(){return location.reload()})}),e(".sui-form-field input[type=number]").length&&e(".sui-form-field input[type=number]").on("keydown",function(t){e(this)[0].hasAttribute("min")&&0<=e(this).attr("min")&&(0!==t.originalEvent.key.replace(/[^0-9^.^,]/,"").length||t.originalEvent.ctrlKey||t.originalEvent.metaKey||t.preventDefault())}),setTimeout(function(){e(".hustle-scroll-to").length&&e("html, body").animate({scrollTop:e(".hustle-scroll-to").offset().top},"slow")},100),e("#hustle-check-all").on("click",function(t){var i=e(t.target),s=i.parents(".sui-wrap").find(".hustle-list"),n=i.is(":checked");s.find(".hustle-listing-checkbox").prop("checked",n),e("#hustle-apply-button").prop("disabled",!n)}),e(".hustle-list .hustle-listing-checkbox").on("click",function(t){var i=e(t.target),s=i.parents(".sui-wrap").find(".hustle-list"),n=i.is(":checked")&&!s.find(".hustle-listing-checkbox:not(:checked)").length,a=0===s.find(".hustle-listing-checkbox:checked").length;e("#hustle-check-all").prop("checked",n),e("#hustle-apply-button").prop("disabled",a)}),e("#hustle-apply-button").on("click",function(t){var i=e(t.target),s=e("select option:selected",i.closest(".sui-box")).val(),n=e(".hustle-list .hustle-listing-checkbox:checked");if(0===n.length||"undefined"===s)return!1;var a=[];if(e.each(n,function(){a.push(e(this).val())}),"delete-all"===s){var o={ids:a.join(","),nonce:i.siblings("#hustle_nonce").val(),dialogQuality:"plural",dialogType:i.data("type"),action:s};return Module.deleteModal.open(o),!1}}),"keep_show"===e("select[name=after_close]").val()&&e("#hustle_after_close").hide(),e("select[name=after_close]").on("change",function(t){"keep_show"===e(this).val()?e("#hustle_after_close").hide():e("#hustle_after_close").show()})}),window.Hustle.moduleToggleModuleTracking=function(t){var i=e(t.currentTarget),s=i.data("id"),n=i.data("nonce"),a=i.data("enabled");e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_toggle_module_tracking",id:s,enabled:a,_ajax_nonce:n}}).done(function(e){if(e.success){var t=i.data("module-name"),s=a?optinVars.messages.commons.tracking_disabled:optinVars.messages.commons.tracking_enabled;Module.Notification.open("success",s.replace(/{module-name}/g,t),1e4),i.trigger("hustle_success_toggle_module_tracking",[i,a])}}).error(function(e){console.log(e)}).always(function(){e(".sui-button-onload").removeClass("sui-button-onload")})},window.Hustle.moduleToggleModuleTrackingTypes=function(t){var i=e(t.currentTarget),s=e("#hustle-module-manage-trackind-id").val(),n=i.data("nonce"),a=[];i.addClass("sui-button-onload"),e('input[name="tracking_sub_types[]"]:checked').each(function(){a.push(e(this).val())}),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_toggle_module_tracking",id:s,types:a.toString(),_ajax_nonce:n}}).done(function(e){e.success&&i.trigger("hustle_success_toggle_module_tracking_types",[s,a])}).error(function(e){console.log(e)}).always(function(){e(".sui-button-onload").removeClass("sui-button-onload")})}}(jQuery),Hustle.define("Modals.Migration",function(e){"use strict";new(Backbone.View.extend({el:"#hustle-dialog--migrate",data:{},events:{"click #hustle-migrate-start":"migrateStart","click #hustle-create-new-module":"createModule","click .hustle-allow-closing":"closeDialog","click .sui-box-selector":"enableContinue","click .sui-onboard-skip":"dismissModal","click .sui-dialog-overlay":"dismissModal"},initialize:function(){var e=this;this.$el.length&&(setTimeout(function(){return SUI.dialogs[e.$el.prop("id")].show()},100),this.$progressBar=this.$el.find(".sui-progress .sui-progress-bar span"),this.$progressText=this.$el.find(".sui-progress .sui-progress-text span"),this.$partialRows=this.$el.find("#hustle-partial-rows"))},migrateStart:function(t){var i=e(t.target),s=this.$el,n=s.find('li[data-slide="2"]'),a=n.find("#dialogDescription"),o=s.find(".sui-slider-navigation");i.addClass("sui-button-onload"),o.addClass("sui-hidden"),o.attr("aria-hidden","true"),n.find(".sui-onboard-skip").remove(),a.text(a.data("migrate-text")),n.find("div[data-migrate-start]").addClass("sui-hidden"),n.find("div[data-migrate-failed]").addClass("sui-hidden"),n.find("div[data-migrate-progress]").removeClass("sui-hidden"),this.migrateTracking(t),i.removeClass("sui-button-onload"),t.preventDefault()},migrateComplete:function(){var e=this.$el,t=e.find(".sui-dialog-overlay"),i=e.find(".sui-slider-navigation"),s=e.find('li[data-slide="2"]'),n=s.find("#dialogTitle"),a=s.find("#dialogDescription");this.$el.find("sui-button-onload").removeClass("sui-button-onload"),n.text(n.data("done-text")),a.text(a.data("done-text")),s.find("div[data-migrate-progress]").addClass("sui-hidden"),s.find("div[data-migrate-done]").removeClass("sui-hidden"),i.removeClass("sui-hidden"),i.attr("aria-hidden","false"),t.addClass("hustle-allow-closing")},migrateFailed:function(){var e=this.$el.find('li[data-slide="2"]');e.find("#dialogDescription").text(""),e.find("div[data-migrate-start]").addClass("sui-hidden"),e.find("div[data-migrate-failed]").removeClass("sui-hidden"),e.find("div[data-migrate-progress]").addClass("sui-hidden")},updateProgress:function(e,t,i){void 0===this.totalRows&&(this.totalRows=i,this.$el.find("#hustle-total-rows").text(i)),this.$partialRows.text(e);var s=t+"%";this.$progressBar.css("width",s),100>=t&&this.$progressText.text(t+"%")},migrateTracking:function(t){t.preventDefault();var i=this,s={action:"hustle_migrate_tracking",_ajax_nonce:e(t.currentTarget).data("nonce")};return e.ajax({type:"POST",url:ajaxurl,dataType:"json",data:s,success:function(e){if(e.success){var s=e.data.migrated_rows,n=e.data.migrated_percentage,a=e.data.total_entries||"0";"done"!==e.data.current_meta?(i.updateProgress(s,n,a),i.migrateTracking(t)):(i.updateProgress(s,n,a),setTimeout(function(){return i.migrateComplete()},500))}else i.migrateFailed()},error:function(e){i.migrateFailed()}}),!1},createModule:function(t){var i=e(t.target),s=this.$el.find(".sui-box-selector input:checked");if(s.length){this.dismissModal(),i.addClass("sui-button-onload");var n=s.val(),a=void 0!==optinVars.module_page[n]?optinVars.module_page[n]:optinVars.module_page.popup;window.location="?page=".concat(a,"&create-module=true")}t.preventDefault()},closeDialog:function(e){var t=this.$el.attr("id");SUI.dialogs[t].hide(),e.preventDefault(),e.stopPropagation()},enableContinue:function(){this.$el.find("#hustle-create-new-module").prop("disabled",!1)},dismissModal:function(t){t&&t.preventDefault(),e.post(ajaxurl,{action:"hustle_dismiss_notification",name:"migrate_modal",_ajax_nonce:this.$el.data("nonce")})}}))}),Hustle.define("Upgrade_Modal",function(e){"use strict";return Backbone.View.extend({el:"#wph-upgrade-modal",opts:{},events:{"click .wpmudev-i_close":"close"},initialize:function(e){this.opts=_.extend({},this.opts,e)},close:function(e){e.preventDefault(),e.stopPropagation(),this.$el.removeClass("wpmudev-modal-active")}})}),Hustle.define("Modals.Welcome",function(e){"use strict";new(Backbone.View.extend({el:"#hustle-dialog--welcome",events:{"click #hustle-new-create-module":"createModule","click .sui-box-selector":"enableContinue","click #getStarted":"dismissModal","click .sui-onboard-skip":"dismissModal","click .sui-dialog-close":"dismissModal"},initialize:function(){this.$el.length&&setTimeout(this.show,100,this)},show:function(e){"undefined"!=typeof SUI&&void 0!==SUI.dialogs?void 0!==SUI.dialogs[e.$el.prop("id")]&&SUI.dialogs[e.$el.prop("id")].show():setTimeout(e.show,100,e)},createModule:function(t){var i=e(t.target),s=this.$el.find(".sui-box-selector input:checked");if(s.length){i.addClass("sui-button-onload");var n=s.val(),a=void 0!==optinVars.module_page[n]?optinVars.module_page[n]:optinVars.module_page.popup;window.location="?page=".concat(a,"&create-module=true")}t.preventDefault()},enableContinue:function(){this.$el.find("#hustle-new-create-module").prop("disabled",!1)},dismissModal:function(t){t&&t.preventDefault(),e.post(ajaxurl,{action:"hustle_dismiss_notification",name:"welcome_modal",_ajax_nonce:this.$el.data("nonce")})}}))}),Hustle.define("Featured_Image_Holder",function(e){"use strict";return Backbone.View.extend({template:Optin.template("wph-wizard-choose_image"),targetDiv:"",mediaFrame:!1,options:{attribute:"feature_image",title:optinVars.messages.media_uploader.select_or_upload,button_text:optinVars.messages.media_uploader.use_this_image,multiple:!1},initialize:function(t){if(this.options=_.extend({},this.options,t),!this.model||!this.options.attribute)throw new Error("Undefined model or attribute");this.targetDiv=t.targetDiv,e(document).on("click",".wpmudev-feature-image-browse",e.proxy(this.open,this)),e(document).on("click","#wpmudev-feature-image-clear",e.proxy(this.clear,this)),this.render()},render:function(){var e=this.template({image:this.model.get(this.options.attribute)});return this.setElement(e),this.defineMediaFrame(),this},showImagePreviewOrButton:function(){var e=this.model.get("feature_image");""===e||void 0===e?this.targetDiv.removeClass("sui-has_file"):this.targetDiv.addClass("sui-has_file")},defineMediaFrame:function(){var e=this;this.mediaFrame=wp.media({title:e.options.title,button:{text:e.options.button_text},multiple:e.options.multiple}).on("select",function(){var t,i,s=e.mediaFrame.state().get("selection").first().toJSON();s&&s.url&&(t=s.url,i="",e.model.set("feature_image",t),s.sizes&&s.sizes.thumbnail&&s.sizes.thumbnail.url&&(i=s.sizes.thumbnail.url),e.targetDiv.find(".sui-upload-file span").text(t).change(),e.targetDiv.find(".sui-image-preview").css("background-image","url( "+i+" )"),e.showImagePreviewOrButton())})},open:function(e){e.preventDefault(),this.mediaFrame.open()},clear:function(e){e.preventDefault(),this.model.set("feature_image",""),this.targetDiv.find(".sui-upload-file span").text("").change(),this.targetDiv.find(".sui-image-preview").css("background-image","url()"),this.showImagePreviewOrButton()}})}),Hustle.define("Modals.Edit_Field",function(e){"use strict";return Backbone.View.extend({el:"#hustle-dialog--edit-field",events:{"click .sui-dialog-overlay":"closeModal","click .hustle-discard-changes":"closeModal",'change input[name="time_format"]':"changeTimeFormat","click #hustle-apply-changes":"applyChanges",'blur input[name="name"]':"trimName","change input":"fieldUpdated","change select":"fieldUpdated"},initialize:function(e){this.field=e.field,this.changed={},this.fieldData=e.fieldData,this.model=e.model,this.render()},render:function(){this.renderHeader(),this.renderSettings(),this.renderStyling()},renderHeader:function(){this.$(".sui-box-header .sui-tag").text(this.field.type)},renderSettings:function(){var t="hustle-"+this.field.type+"-field-settings-tpl";e("#"+t).length||(t="hustle-common-field-settings-tpl");var i=Optin.template(t);this.$("#hustle-data-pane--settings").html(i(this.fieldData)),Hustle.Events.trigger("view.rendered",this),"gdpr"===this.field.type&&(wp.editor.remove("gdpr_message"),wp.editor.initialize("gdpr_message",{tinymce:{wpautop:!1,toolbar1:"bold,italic,strikethrough,link",valid_elements:"a[href|target=_blank],strong/b,i,u,s,em,del",forced_root_block:""},quicktags:{buttons:"strong,em,del,link"}})),this.$("#hustle-data-tab--settings").trigger("click")},renderStyling:function(){var t="hustle-"+this.field.type+"-field-styling-tpl";e("#"+t).length||(t="hustle-common-field-styling-tpl");var i=Optin.template(t);this.$("#hustle-data-pane--styling").html(i(this.fieldData))},fieldUpdated:function(t){var i=e(t.target),s=i.attr("name"),n=i.is(":checkbox")?i.is(":checked"):i.val();this.changed[s]=n},closeModal:function(){this.undelegateEvents(),this.stopListening(),SUI.dialogs["hustle-dialog--edit-field"].hide()},changeTimeFormat:function(t){"12"===e(t.target).val()?(e("#hustle-date-format").closest(".sui-form-field").show(),e('input[name="time_hours"]').prop("min",1).prop("max",12)):(e("#hustle-date-format").closest(".sui-form-field").hide(),e('input[name="time_hours"]').prop("min",0).prop("max",23))},trimName:function(t){var i,s=this.$(t.target);i=e.trim(s.val()).replace(/ /g,"_"),s.val(i)},applyChanges:function(e){var t=this,i=this.$(e.target),s=Object.assign({},this.model.get("form_elements"));if("gdpr"===this.field.type&&"undefined"!=typeof tinyMCE){var n=tinyMCE.get("gdpr_message"),a=this.$("textarea#gdpr_message"),o="true"===a.attr("aria-hidden")?n.getContent():a.val();s.gdpr.gdpr_message=o,this.model.set("form_elements",s),this.model.userHasChange()}if(Object.keys(this.changed).length){var l=_.extend({},this.field);_.extend(this.field,this.changed),"name"in this.changed||"email"===l.name?"email"===l.name&&(this.field.name="email"):(s[this.field.name]=this.field,this.model.set("form_elements",s),this.model.userHasChange()),this.trigger("field:updated",this.field,this.changed,l)}i.addClass("sui-button-onload"),setTimeout(function(){t.closeModal(),i.removeClass("sui-button-onload")},300)}})}),Hustle.define("Modals.Optin_Fields",function(e){"use strict";return Backbone.View.extend({el:"#hustle-dialog--optin-fields",events:{"click .sui-box-selector input":"selectFields","click .sui-dialog-overlay":"closeModal","click .hustle-cancel-insert-fields":"closeModal","click #hustle-insert-fields":"insertFields"},initialize:function(){this.selectedFields=[]},selectFields:function(e){var t=this.$(e.target),i=t.val();this.$el.find('label[for="'+t.attr("id")+'"]').toggleClass("selected"),t.prop("checked")?this.selectedFields.push(i):this.selectedFields=_.without(this.selectedFields,i)},insertFields:function(e){var t=this,i=this.$(e.target);i.addClass("sui-button-onload"),this.trigger("fields:added",this.selectedFields),setTimeout(function(){i.removeClass("sui-button-onload"),t.closeModal()},500)},closeModal:function(){this.undelegateEvents(),this.stopListening();var e=this.$el.find(".sui-box-selector:not(.hustle-skip)"),t=e.find("input");SUI.dialogs["hustle-dialog--optin-fields"].hide(),e.removeClass("selected"),t.prop("checked",!1),t[0].checked=!1}})}),Hustle.define("Modals.Visibility_Conditions",function(e){"use strict";return Backbone.View.extend({el:"#hustle-dialog--visibility-options",selectedConditions:[],opts:{groupId:0,conditions:[]},events:{"click .sui-box-selector input":"selectConditions","click .hustle-cancel-conditions":"cancelConditions","click .sui-dialog-overlay":"cancelConditions","click #hustle-add-conditions":"addConditions"},initialize:function(e){this.opts=_.extend({},this.opts,e),this.selectedConditions=this.opts.conditions,this.$(".hustle-visibility-condition-option").prop("checked",!1).prop("disabled",!1);var t=!0,i=!1,s=void 0;try{for(var n,a=this.selectedConditions[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){var o=n.value;this.$("#hustle-condition--"+o).prop("checked",!0).prop("disabled",!0)}}catch(e){i=!0,s=e}finally{try{t||null==a.return||a.return()}finally{if(i)throw s}}},selectConditions:function(e){var t=this.$(e.target),i=this.$el.find('label[for="'+t.attr("id")+'"]'),s=t.val();i.toggleClass("selected"),t.prop("checked")?this.selectedConditions.push(s):this.selectedConditions=_.without(this.selectedConditions,s)},cancelConditions:function(){SUI.dialogs["hustle-dialog--visibility-options"].hide()},addConditions:function(e){var t=this,i=this.$(e.target);i.addClass("sui-button-onload"),this.trigger("conditions:added",{groupId:i.data("group_id"),conditions:this.selectedConditions}),setTimeout(function(){SUI.dialogs["hustle-dialog--visibility-options"].hide(),i.removeClass("sui-button-onload"),t.undelegateEvents()},500)}})}),function(e){"use strict";Optin.listingBase=Hustle.View.extend({el:".sui-wrap",logShown:!1,moduleType:"",_events:{"click .hustle-create-module":"openCreateModal","click .hustle-delete-module-button":"openDeleteModal","click .hustle-module-tracking-reset-button":"openResetTrackingModal","click .hustle-manage-tracking-button":"openManageTrackingModal","click .hustle-import-new-module":"openImportNewModal","click .hustle-module-import-button":"openImportExistingModal","click .hustle-upgrade-modal-button":"openUpgradeModal","change #sui-upload-button":"selectUploadFile","click #hustle-upload-button":"import","click .sui-upload-file button":"resetUploadFile","click .sui-upload-file":"changeFile","click .hustle-preview-module-button":"openPreview","click .hustle-toggle-status-module-button":"toggleModuleStatus","click .hustle-toggle-tracking-module-button":"toggleTracking","click #hustle-manage-tracking-types":"toggleTrackingTypes","click #hustle-dialog--tracking-reset-data .hustle-delete":"resetTrackingData","click form.sui-bulk-actions button":"bulkActionCheck","click #hustle-bulk-action-delete-confirmation .hustle-delete":"bulkActionSend","click #hustle-bulk-action-reset-tracking-confirmation .hustle-delete":"bulkActionSend","click .sui-accordion-item-action .hustle-onload-icon-action":"addLoadingIconToActionsButton"},initialize:function(t){if(this.events=e.extend(!0,{},this.events,this._events),this.delegateEvents(),this.moduleType=t.moduleType,new(Hustle.get("Modals.New_Module"))({moduleType:this.moduleType}),e("div.sui-accordion-item-header").on("click",e.proxy(this.openTrackingData,this)),this.$el.on("hustle_success_toggle_module_tracking",e.proxy(this.SuccessToggleTracking,this)),this.$el.on("hustle_success_toggle_module_tracking_types",e.proxy(this.SuccessToggleTrackingTypes,this)),e(".hustle-display-chart").length&&this.openTrackingData(e(".hustle-display-chart")),"true"===Module.Utils.getUrlParam("create-module")&&setTimeout(function(){return SUI.dialogs["hustle-dialog--add-new-module"].show()},100),"true"===Module.Utils.getUrlParam("requires-pro")){var i=this;setTimeout(function(){return i.openUpgradeModal()},100)}},SuccessToggleTracking:function(e,t,i){var s=t.parents(".sui-accordion-item");t.data("enabled",1-i),t.find("span").toggleClass("sui-hidden"),s.hasClass("sui-accordion-item--open")&&s.find(".sui-accordion-open-indicator").trigger("click").trigger("click")},SuccessToggleTrackingTypes:function(t,i,s){var n=e('.hustle-manage-tracking-button[data-module-id="'+i+'"]'),a=n.parents(".sui-accordion-item");SUI.dialogs["hustle-dialog--manage-tracking"].hide(),n.data("tracking-types",s.toString()),a.hasClass("sui-accordion-item--open")&&a.find(".sui-accordion-open-indicator").trigger("click").trigger("click")},openPreview:function(t){var i=e(t.currentTarget),s=i.data("id"),n=i.data("type");Module.preview.open(s,n)},openDeleteModal:function(t){t.preventDefault();var i=e(t.currentTarget),s={id:i.data("id"),nonce:i.data("nonce"),dialogType:i.data("type"),action:"delete"};Module.deleteModal.open(s)},import:function(t){var i,s=e(t.currentTarget),n=e("#hustle-dialog--import .sui-notice-error"),a=e("#sui-upload-button").get(0).files[0];s.addClass("sui-button-onload"),(i=new FormData).append("action","hustle_import_module"),i.append("type",s.data("type")),i.append("module_id",s.data("module_id")),i.append("_ajax_nonce",s.data("nonce")),i.append("file",a),e.ajax({url:ajaxurl,type:"POST",data:i,cache:!1,processData:!1,contentType:!1,success:function(e){e.success?location.reload():e.data.redirect_url?window.location.replace(e.data.redirect_url):(e.data.error_message&&n.find("p").text(e.data.error_message),n.show(),s.removeClass("sui-button-onload"))},error:function(){n.show()}})},resetUploadFile:function(t){t.stopPropagation(),e("#sui-upload-button").val("").trigger("change")},changeFile:function(t){e("#sui-upload-button").trigger("click")},openTrackingData:function(t){var i="";if(t.target){if(e(t.target).closest(".sui-accordion-item-action").length)return!0;t.preventDefault(),t.stopPropagation(),i=e(t.currentTarget)}else i=t;var s=this,n=i.parent(),a=n.find(".sui-chartjs-animated");if(n.hasClass("sui-accordion-item--disabled")?n.removeClass("sui-accordion-item--open"):n.hasClass("sui-accordion-item--open")?n.removeClass("sui-accordion-item--open"):n.addClass("sui-accordion-item--open"),n.find(".sui-accordion-item-data").addClass("sui-onload"),a.removeClass("sui-chartjs-loaded"),n.hasClass("sui-accordion-item--open")){var o={id:i.data("id"),_ajax_nonce:i.data("nonce"),action:"hustle_tracking_data"};e.ajax({url:ajaxurl,type:"POST",data:o,success:function(e){e.success&&e.data&&(n.find(".sui-accordion-item-body").html(e.data.html),e.data.chart.forEach(s.newChart),a=n.find(".sui-chartjs-animated"),SUI.suiTabs()),n.find(".sui-accordion-item-data").removeClass("sui-onload"),a.addClass("sui-chartjs-loaded")},error:function(e){n.find(".sui-accordion-item-data").removeClass("sui-onload"),a.addClass("sui-chartjs-loaded")}})}},newChart:function(e){var t=document.getElementById(e.id),i=e.days,s=e.views,n={labels:i,datasets:[{label:"Submissions",data:e.submissions,backgroundColor:["#E1F6FF"],borderColor:["#17A8E3"],borderWidth:2,pointRadius:0,pointHitRadius:20,pointHoverRadius:5,pointHoverBorderColor:"#17A8E3",pointHoverBackgroundColor:"#17A8E3"},{label:"Views",data:s,backgroundColor:["#F8F8F8"],borderColor:["#DDDDDD"],borderWidth:2,pointRadius:0,pointHitRadius:20,pointHoverRadius:5,pointHoverBorderColor:"#DDDDDD",pointHoverBackgroundColor:"#DDDDDD"}]},a={maintainAspectRatio:!1,legend:{display:!1},scales:{xAxes:[{display:!1,gridLines:{color:"rgba(0, 0, 0, 0)"}}],yAxes:[{display:!1,gridLines:{color:"rgba(0, 0, 0, 0)"},ticks:{beginAtZero:!1,min:0,max:e.max_views_date,stepSize:1}}]},elements:{line:{tension:0},point:{radius:.5}},tooltips:{custom:function(e){e&&(e.displayColors=!1)},callbacks:{title:function(e,t){return 0===e[0].datasetIndex?optinVars.labels.submissions.replace("%d",e[0].yLabel):1===e[0].datasetIndex?optinVars.labels.views.replace("%d",e[0].yLabel):void 0},label:function(e,t){return e.xLabel},labelTextColor:function(e,t){return"#AAAAAA"}}}};if(t)new Chart(t,{type:"line",fill:"start",data:n,options:a})},selectUploadFile:function(t){var i=e(t.target).val().replace(/C:\\fakepath\\/i,"");e("#hustle-dialog--import .sui-notice-error ").hide(),i?(e(".sui-upload-file span:first").text(i),e("#hustle-dialog--import .sui-notice-error p strong").text(i),e(".sui-upload").addClass("sui-has_file"),e("#hustle-upload-button").prop("disabled",!1)):(e(".sui-upload").removeClass("sui-has_file"),e(".sui-upload-file span:first").text(""),e("#hustle-dialog--import .sui-notice-error p strong").text(""),e("#hustle-upload-button").prop("disabled",!0))},getChecked:function(t){var i=".sui-wrap .sui-accordion-item-title input[type=checkbox]";return"checked"===t&&(i+=":checked"),e(i)},bulkActionCheck:function(t){var i=e(t.target),s=e("select option:selected",i.closest(".sui-box")).val();return 0!==this.getChecked("checked").length&&("undefined"!==s&&("delete"===s?(SUI.dialogs["hustle-bulk-action-delete-confirmation"].show(),!1):"reset-tracking"===s?(SUI.dialogs["hustle-bulk-action-reset-tracking-confirmation"].show(),!1):void this.bulkActionSend(t)))},bulkActionSend:function(t){this.addLoadingIcon(t);var i=e(".sui-bulk-actions button"),s=e("select option:selected",i.closest(".sui-box")).val(),n=this.getChecked("checked");if(0===n.length)return!1;var a=[];e.each(n,function(){a.push(e(this).val())});var o={ids:a,hustle:s,type:i.data("type"),_ajax_nonce:i.data("nonce"),action:"hustle_listing_bulk"};e.ajax({url:ajaxurl,type:"POST",data:o,success:function(e){e.success?location.reload():(SUI.dialogs["hustle-bulk-action-delete-confirmation"].hide(),SUI.dialogs["hustle-bulk-action-reset-tracking-confirmation"].hide())}})},toggleModuleStatus:function(t){var i=e(t.currentTarget),s=i.data("id"),n=i.data("nonce"),a=i.data("enabled"),o=i.data("type");e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_toggle_module_state",id:s,type:o,enabled:a,_ajax_nonce:n}}).done(function(e){if(e.success){var t=i.closest(".sui-accordion-item"),s=t.find(".sui-accordion-item-title span.sui-tag");i.data("enabled",1-a),a?(s.text(s.data("draft")),s.removeClass("sui-tag-blue"),s.attr("data-status","draft")):(s.text(s.data("publish")),s.addClass("sui-tag-blue"),s.attr("data-status","published")),i.find("span").toggleClass("sui-hidden"),t.hasClass("sui-accordion-item--open")&&t.find(".sui-accordion-open-indicator").trigger("click").trigger("click")}}).error(function(e){console.log(e)}).always(function(){e(".sui-button-onload").removeClass("sui-button-onload")})},toggleTracking:function(e){window.Hustle.moduleToggleModuleTracking(e)},toggleTrackingTypes:function(e){window.Hustle.moduleToggleModuleTrackingTypes(e)},resetTrackingData:function(e){Module.resetTrackingDataModal.reset(e)},openResetTrackingModal:function(t){t.preventDefault();var i=e(t.target),s={id:i.data("id"),nonce:i.data("nonce")};Module.resetTrackingDataModal.open(s)},openManageTrackingModal:function(t){var i=Optin.template("hustle-manage-tracking-form-tpl"),s=e(t.currentTarget),n={moduleID:s.data("module-id"),enabledTrackings:s.data("tracking-types").split(",")};e("#hustle-dialog--manage-tracking #hustle-manage-tracking-form-container").html(i(n)),SUI.dialogs["hustle-dialog--manage-tracking"].show()},addLoadingIcon:function(t){e(t.currentTarget).addClass("sui-button-onload")},actionClicked:function(t){console.log(e(t.currentTarget))},addLoadingIconToActionsButton:function(t){e(t.currentTarget).closest(".sui-accordion-item-action").find(".sui-dropdown-anchor").addClass("sui-button-onload")},openCreateModal:function(t){!1===e(t.currentTarget).data("enabled")?this.openUpgradeModal():SUI.dialogs["hustle-dialog--add-new-module"].show()},openUpgradeModal:function(t){t&&(t.preventDefault(),t.stopPropagation()),e(".sui-button-onload").removeClass("sui-button-onload"),e("#hustle-dialog--upgrade-to-pro").length&&SUI.dialogs["hustle-dialog--upgrade-to-pro"].show()},openImportNewModal:function(t,i){if(!1===e(t.currentTarget).data("enabled"))this.openUpgradeModal();else{var s=e("#hustle-dialog--import #hustle-upload-button");void 0===i?s.removeAttr("data-module_id"):s.attr("data-module_id",i),SUI.dialogs["hustle-dialog--import"].show()}},openImportExistingModal:function(t){var i=e(t.currentTarget),s=e("button",i.closest("li"));this.openImportNewModal(t,s.data("id"))}})}(jQuery),Hustle.define("Modals.New_Module",function(e){"use strict";return Backbone.View.extend({el:"#hustle-dialog--add-new-module",data:{},events:{"click #hustle-select-mode":"modeSelected","keypress #module-mode-step":"maybeModeSelected","click #hustle-create-module":"createModule","keypress #module-name-step":"maybeCreateModule","click .sui-dialog-back":"goToModeStep",'change input[name="mode"]':"modeChanged",'keydown input[name="name"]':"nameChanged"},initialize:function(e){_.extend(this.data,e)},modeChanged:function(t){var i=e(t.target).val();this.data.mode=i,this.$el.find("#hustle-select-mode").prop("disabled",!1)},nameChanged:function(t){var i=this;setTimeout(function(){i.$(".sui-error-message").hide();var s=e(t.target).val();i.data.name=s,0===s.trim().length?(i.$("#hustle-create-module").prop("disabled",!0),i.$("#error-empty-name").closest(".sui-form-field").addClass("sui-form-field-error"),i.$("#error-empty-name").show()):(i.$("#hustle-create-module").prop("disabled",!1),i.$("#error-empty-name").closest(".sui-form-field").removeClass("sui-form-field-error"),i.$("#error-empty-name").hide())},300)},modeSelected:function(e){e.preventDefault(),this.$el.find('input[name="mode"]:checked').trigger("change"),0!==Object.keys(this.data).length&&(this.$el.addClass("sui-dialog-sm"),this.$el.find("#module-mode-step").hide(),this.$el.find("#module-name-step").show())},maybeCreateModule:function(e){13===e.which&&this.$("#hustle-create-module").click()},maybeModeSelected:function(e){13===e.which&&this.$("#hustle-select-mode").click()},goToModeStep:function(e){this.$el.removeClass("sui-dialog-sm"),this.$el.find("#module-mode-step").show(),this.$el.find("#module-name-step").hide()},createModule:function(t){var i=e(t.target).closest("#module-name-step"),s=i.find("#error-saving-settings"),n=i.find("#hustle-create-module"),a=i.data("nonce");if(void 0===this.data.mode&&"social_sharing"!==this.data.moduleType||void 0===this.data.name||0===this.data.name.length)return s.show(),void n.removeClass("sui-button-onload");s.hide(),n.addClass("sui-button-onload"),e.ajax({url:ajaxurl,type:"POST",data:{data:{module_name:this.data.name,module_mode:this.data.mode,module_type:this.data.moduleType},action:"hustle_create_new_module",_ajax_nonce:a}}).done(function(e){e&&e.data&&e.data.redirect_url?window.location.replace(e.data.redirect_url):(s.show(),n.removeClass("sui-button-onload"))}).fail(function(){s.show(),n.removeClass("sui-button-onload")})}})}),Hustle.define("Mixins.Model_Updater",function(e,t,i){"use strict";return{initMix:function(){this.events=_.extend({},this.events,this._events),this.delegateEvents()},_events:{'change input[type="text"]':"_updateText",'change input[type="url"]':"_updateText",'change input[type="hidden"]':"_updateText",'change input[type="number"]':"_updateText",'change input[type="checkbox"]':"_updateCheckbox","change input[type=radio]":"_updateRadios","change select":"_updateSelect"},_updateText:function(t){var i=e(t.target),s=i.data("attribute"),n=this[i.data("model")||"model"],a=_.isTrue(i.data("silent"))?{silent:!0}:{};n&&s&&(t.stopPropagation(),n.set.call(n,s,t.target.value,a))},_updateCheckbox:function(t){var i=e(t.target),s=i.data("attribute"),n=i.val(),a=this[i.data("model")||"model"],o=_.isTrue(i.data("silent"))?{silent:!0}:{};if(a&&s)if(t.stopPropagation(),"on"!==n){var l=a.get.call(a,s);i.is(":checked")?l.push(n):l=_.without(l,n),a.set.call(a,s,l,o)}else a.set.call(a,s,i.is(":checked")?1:0,o)},_updateRadios:function(t){var i=e(t.target),s=i.data("attribute"),n=this[i.data("model")||"model"],a=_.isTrue(i.data("silent"))?{silent:!0}:{};n&&s&&(t.stopPropagation(),n.set.call(n,s,t.target.value,a))},_updateSelect:function(t){var i=e(t.target),s=i.data("attribute"),n=this[i.data("model")||"model"],a=_.isTrue(i.data("silent"))?{silent:!0}:{};n&&s&&(t.stopPropagation(),n.set.call(n,s,i.val(),a))}}}),Hustle.define("Mixins.Module_Settings",function(e,t,i){"use strict";return _.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("hustle-wizard-behaviour-tpl"),targetContainer:e("#hustle-wizard-behaviour"),events:{},init:function(e){if(this.stopListening(this.model,"change",this.viewChanged),this.listenTo(this.model,"change",this.viewChanged),this.stopListening(this.model.get("triggers"),"change",this.viewChanged),this.listenTo(this.model.get("triggers"),"change",this.viewChanged),this.targetContainer.length)return this.render()},render:function(e){var t=this.model.toJSON();return this.setElement(this.template(_.extend({shortcode_id:optinVars.current.shortcode_id},t))),this},afterRender:function(){this.targetContainer.length},viewChanged:function(e){var t=e.changed;if("on_scroll"in t){var i=this.$("#hustle-on-scroll--scrolled-toggle-wrapper"),s=this.$("#hustle-on-scroll--selector-toggle-wrapper");(i.length||s.length)&&("scrolled"===t.on_scroll?(i.removeClass("sui-hidden"),s.addClass("sui-hidden")):(s.removeClass("sui-hidden"),i.addClass("sui-hidden")))}if("enable_on_click_element"in t){var n=this.$("#hustle-enable-on-click-element-toggle-wrapper");n.length&&(t.enable_on_click_element?n.removeClass("sui-hidden"):n.addClass("sui-hidden"))}if("enable_on_click_shortcode"in t){var a=this.$("#hustle-enable-on-click-shortcode-toggle-wrapper");a.length&&(t.enable_on_click_shortcode?a.removeClass("sui-hidden"):a.addClass("sui-hidden"))}if("on_exit_intent_delayed"in t){var o=this.$("#hustle-trigger-exit--delay-toggle-wrapper");o.length&&(t.on_exit_intent_delayed?o.removeClass("sui-hidden"):o.addClass("sui-hidden"))}if("auto_hide"in t){var l=this.$("#hustle-auto-hide-toggle-wrapper"),d=this.$("#hustle-closing-behaviour--timer-label");(l.length||d.length)&&(t.auto_hide?(l.removeClass("sui-hidden"),d.show()):(l.addClass("sui-hidden"),d.hide()))}if("close_on_background_click"in t){var r=this.$("#hustle-closing-behaviour--mask-label");r.length&&(t.close_on_background_click?r.show():r.hide())}if("on_submit"in t){var u=this.$("#hustle-on-submit-delay-wrapper");u.length&&("nothing"!==t.on_submit?u.removeClass("sui-hidden"):u.addClass("sui-hidden"))}}})}),Hustle.define("Mixins.Module_Content",function(e,t,i){"use strict";return _.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("hustle-wizard-content-tpl"),moduleType:"",targetContainer:e("#hustle-wizard-content"),events:{},init:function(e){this.stopListening(this.model,"change",this.modelUpdated),this.listenTo(this.model,"change",this.modelUpdated),this.moduleType=e.moduleType},render:function(){var e;if(this.targetContainer.length)return e=this.model.toJSON(),this.setElement(this.template(_.extend({module_type:this.moduleType},e))),this},afterRender:function(){this.targetContainer.length&&this.renderFeaturedImage(),optinVars.is_new&&Module.Notification.open("success",optinVars.messages.commons.module_created.replace(/{type_name}/g,optinVars.module_name[this.moduleType]),1e4)},renderFeaturedImage:function(){var e=Hustle.get("Featured_Image_Holder"),t=this.$("#wph-wizard-choose_image");t.length&&(this.mediaHolder=new e({model:this.model,attribute:"feature_image",moduleType:this.moduleType,targetDiv:t}),t.html(""),t.html(this.mediaHolder.$el))},modelUpdated:function(e){var t=e.changed;if("module_name"in t&&this.model.set("module_name",t.module_name,{silent:!0}),"feature_image"in t&&Hustle.Events.trigger("modules.view.feature_image_updated",t),"show_never_see_link"in t){var i=this.$("#hustle-add-never-see-link-toggle-wrapper");i.length&&(t.show_never_see_link?i.removeClass("sui-hidden"):i.addClass("sui-hidden"))}if("show_cta"in t){var s=this.$("#hustle-show-cta-toggle-wrapper");s.length&&(t.show_cta?s.removeClass("sui-hidden"):s.addClass("sui-hidden"))}if("show_gdpr"in t){var n=this.$("#hustle-show-gdpr-toggle-wrapper");n.length&&(t.show_gdpr?n.removeClass("sui-hidden"):n.addClass("sui-hidden"))}}})}),Hustle.define("Mixins.Module_Design",function(e,t,i){"use strict";return _.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("hustle-wizard-appearance-tpl"),targetContainer:e("#hustle-wizard-appearance"),cssEditor:!1,beforeRender:_.noop,modalSelectors:{".hustle-layout .hustle-layout-body ":"Layout",".hustle-layout .hustle-title":"Title",".hustle-layout .hustle-subtitle ":"Subtitle",".hustle-layout .hustle-layout-body .hustle-image img ":"Feat. Image",".hustle-layout .hustle-layout-body .hustle-group-content p ":"Main Content",".hustle-layout .hustle-button-cta ":"CTA Button",".hustle-button-close ":"Close Button"},formSelectors:{".hustle-layout .hustle-layout-body .hustle-layout-form ":"Form Container",".hustle-layout .hustle-layout-body .hustle-layout-form .hustle-input ":"Input",".hustle-layout .hustle-layout-body .hustle-layout-form .hustle-button-submit ":"Submit",".hustle-success ":"Success Container",".hustle-success .hustle-success-content p ":"Success Message"},formExtraSelectors:{".hustle-layout .hustle-layout-body .hustle-form-options ":"Container",".hustle-layout .hustle-layout-body .hustle-form-options .hustle-group-title ":"Title",".hustle-layout .hustle-layout-body .hustle-radio span[aria-hidden]":"Radio",".hustle-layout .hustle-layout-body .hustle-radio span:not([aria-hidden])":"Radio (Label)",".hustle-layout .hustle-layout-body .hustle-checkbox span[aria-hidden]":"Checkbox",".hustle-layout .hustle-layout-body .hustle-checkbox span:not([aria-hidden])":"Checkbox (Label)"},events:{"click .hustle-css-stylable":"insertSelector","click .hustle-reset-color-palette":"resetPickers"},init:function(t){if(this.stopListening(this.model,"change",this.viewChanged),this.listenTo(this.model,"change",this.viewChanged),Hustle.Events.off("modules.view.feature_image_updated",e.proxy(this.ViewChangedContentTab,this)),Hustle.Events.on("modules.view.feature_image_updated",e.proxy(this.ViewChangedContentTab,this)),this.beforeRender(),this.targetContainer.length)return this.render()},render:function(e){return this.setElement(this.template(_.extend({modalSelectors:this.modalSelectors,formSelectors:this.formSelectors,formExtraSelectors:this.formExtraSelectors},this.model.toJSON()))),this},afterRender:function(){this.targetContainer.length&&(this.createPickers(),this.createEditor(),this.cssChange())},createPickers:function(){var t=this,i=this.$(".sui-colorpicker-input");i.wpColorPicker({change:function(t,i){e(this).val(i.color.toCSS()).trigger("change")},palettes:["#333333","#FFFFFF","#17A8E3","#E1F6FF","#666666","#AAAAAA","#E6E6E6"]}),i.hasClass("wp-color-picker")&&i.each(function(){var i=e(this),s=i.closest(".sui-colorpicker-wrap"),n=s.find(".sui-colorpicker-value span[role=button]"),a=s.find(".sui-colorpicker-value"),o=a.find("button"),l="hex",d=i.closest(".wp-picker-container"),r=d.find(".wp-color-result"),u=r.find(".color-alpha"),c=d.find(".wp-picker-clear");!0===i.data("alpha")?(l="rgba",i.bind("change",function(){n.find("span").css({"background-color":u.css("background")}),a.find("input").val(i.val())})):i.bind("change",function(){n.find("span").css({"background-color":r.css("background-color")}),a.find("input").val(i.val())}),s.find(".sui-colorpicker").addClass("sui-colorpicker-"+l),s.find(".sui-button, span[role=button]").on("click",function(e){r.click(),e.preventDefault(),e.stopPropagation()}),o.on("click",function(e){var s=i.data("attribute"),o=t.model.get("color_palette"),l=optinVars.palettes[o][s];c.click(),a.find("input").val(l),i.val(l).trigger("change"),n.find("span").css({"background-color":l}),e.preventDefault(),e.stopPropagation()})})},updatePickers:function(e){var t=this;if(void 0!==optinVars.palettes[e]){var i=optinVars.palettes[e];_.each(i,function(e,i){t.$('input[data-attribute="'+i+'"]').val(e).trigger("change")})}},resetPickers:function(t){var i=e(t.target);i.addClass("sui-button-onload").prop("disabled",!0);var s=e('select[data-attribute="color_palette"]').val();this.updatePickers(s),setTimeout(function(){i.removeClass("sui-button-onload").prop("disabled",!1)},500)},createEditor:function(){this.cssEditor=ace.edit("hustle_custom_css"),this.cssEditor.getSession().setMode("ace/mode/css"),this.cssEditor.$blockScrolling=1/0,this.cssEditor.setTheme("ace/theme/sui"),this.cssEditor.getSession().setUseWrapMode(!0),this.cssEditor.getSession().setUseWorker(!1),this.cssEditor.setShowPrintMargin(!1),this.cssEditor.renderer.setShowGutter(!0),this.cssEditor.setHighlightActiveLine(!0)},updateCustomCss:function(){this.cssEditor&&this.model.set("custom_css",this.cssEditor.getValue())},cssChange:function(){var e=this;this.cssEditor.getSession().on("change",function(){e.model.userHasChange()})},insertSelector:function(t){var i=e(t.target).data("stylable")+"{}";this.cssEditor.navigateFileEnd(),this.cssEditor.insert(i),this.cssEditor.navigateLeft(1),this.cssEditor.focus(),t.preventDefault()},viewChanged:function(e){var t=e.changed;if("form_layout"in t){var i=this.$("#hustle-feature-image-position-option"),s=this.$("#hustle-feature-image-above-label"),n=this.$("#hustle-feature-image-below-label");if(s.length||n.length)if("one"===t.form_layout)s.removeClass("sui-hidden"),n.removeClass("sui-hidden");else{var a=e.get("feature_image_position");"left"!==a&&"right"!==a&&(i.find("input").prop("checked",!1),i.find("#hustle-feature-image-left").prop("checked",!0),this.model.set("feature_image_position","left"),i.find(".sui-tab-item").removeClass("active"),i.find("#hustle-feature-image-left-label").addClass("active")),s.addClass("sui-hidden"),n.addClass("sui-hidden")}}if("color_palette"in t&&this.updatePickers(t.color_palette),"border"in t){var o=this.$("#hustle-border-toggle-wrapper");o.length&&(t.border?o.removeClass("sui-hidden"):o.addClass("sui-hidden"))}if("drop_shadow"in t){var l=this.$("#hustle-drop-shadow-toggle-wrapper");l.length&&(t.drop_shadow?l.removeClass("sui-hidden"):l.addClass("sui-hidden"))}if("customize_size"in t){var d=this.$("#hustle-customize-size-toggle-wrapper");d.length&&(t.customize_size?d.removeClass("sui-hidden"):d.addClass("sui-hidden"))}else if("customize_css"in t){var r=this.$("#hustle-customize-css-toggle-wrapper");r.length&&(t.customize_css?r.removeClass("sui-hidden"):r.addClass("sui-hidden"))}else if("feature_image_horizontal"in t){var u=this.$("#hustle-image-custom-position-horizontal");u.length&&("custom"!==t.feature_image_horizontal?u.prop("disabled",!0):u.prop("disabled",!1))}else if("feature_image_vertical"in t){var c=this.$("#hustle-image-custom-position-vertical");c.length&&("custom"!==t.feature_image_vertical?c.prop("disabled",!0):c.prop("disabled",!1))}},ViewChangedContentTab:function(e){if("feature_image"in e){var t=this.$("#hustle-appearance-feature-image-placeholder"),i=this.$("#hustle-appearance-feature-image-settings");t.length&&i.length&&(e.feature_image?(i.show(),t.hide()):(i.hide(),t.show()))}}})}),Hustle.define("Mixins.Module_Display",function(e,t,i){"use strict";return _.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("hustle-wizard-display-tpl"),moduleId:0,moduleType:"",targetContainer:e("#hustle-wizard-display"),events:{},extViewChanged:_.noop,init:function(e){this.stopListening(this.model,"change",this.viewChanged),this.listenTo(this.model,"change",this.viewChanged),this.moduleType=e.moduleType},render:function(){var e;if(this.targetContainer.length)return e=this.model.toJSON(),this.setElement(this.template(_.extend({module_type:this.moduleType},e))),this},afterRender:function(){},viewChanged:function(e){var t=e.changed;if("inline_enabled"in t){var i=this.$("#hustle-inline-toggle-wrapper");i.length&&(t.inline_enabled?i.removeClass("sui-hidden"):i.addClass("sui-hidden"))}else if("widget_enabled"in t){var s=this.$("#hustle-widget-toggle-wrapper");s.length&&(t.widget_enabled?s.removeClass("sui-hidden"):s.addClass("sui-hidden"))}else if("shortcode_enabled"in t){var n=this.$("#hustle-shortcode-toggle-wrapper");n.length&&(t.shortcode_enabled?n.removeClass("sui-hidden"):n.addClass("sui-hidden"))}this.extViewChanged(t)}})}),Hustle.define("Mixins.Module_Emails",function(e,t,i){"use strict";return _.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("hustle-wizard-emails-tpl"),targetContainer:e("#hustle-wizard-emails"),events:{"click .hustle-optin-field--add":"addFields","click .hustle-optin-field--edit":"editField","click .sui-builder-field":"maybeEditField","click .hustle-optin-field--delete":"deleteFieldOnClick","click ul.list-results li":"setFieldOption","click .hustle-optin-field--copy":"duplicateField"},init:function(e){if(this.stopListening(this.model,"change",this.viewChanged),this.listenTo(this.model,"change",this.viewChanged),this.targetContainer.length)return this.render()},render:function(){var t=this.model.toJSON(),i=this.model.get("form_elements");for(var s in this.setElement(this.template(t)),i){var n=i[s];i[s]=_.extend({},this.getFieldDefaults(n.type),n),"submit"!==s&&this.addFieldToPanel(i[s])}this.model.set("form_elements",i,{silent:!0});var a=this.$("#hustle-form-fields-container").sortable({axis:"y",containment:".sui-box-builder"});return a.on("sortupdate",e.proxy(this.fieldsOrderChanged,this,a)),this},afterRender:function(){this.updateDynamicValueFields()},resetDynamicValueFieldsPlaceholders:function(){this.$("select.hustle-field-options").html(""),this.$(".hustle-fields-placeholders-options").length&&this.$(".hustle-fields-placeholders-options").html("")},updateDynamicValueFields:function(){var t=this.model.get("form_elements");for(var i in this.resetDynamicValueFieldsPlaceholders(),t)"submit"!==i&&"recaptcha"!==i&&"gdpr"!==i&&(this.addFieldToDynamicValueFields(t[i]),this.$("select.hustle-field-options").trigger("sui:change"));this.$("div.select-list-container .list-results:empty").each(function(){var t=e(this).closest(".select-container").find("select.hustle-field-options").data("type");e(this).html('<li style="cursor: default; pointer-events: none;">'+optinVars.messages.form_fields.errors.no_fileds_info.replace("{field_type}",t)+"</li>")})},fieldsOrderChanged:function(e){var t=this.model.get("form_elements"),i=e.sortable("toArray",{attribute:"data-field-id"}),s={},n=!0,a=!1,o=void 0;try{for(var l,d=i[Symbol.iterator]();!(n=(l=d.next()).done);n=!0){var r=l.value;s[r]=t[r]}}catch(e){a=!0,o=e}finally{try{n||null==d.return||d.return()}finally{if(a)throw o}}s=_.extend({},s,t),this.model.set("form_elements",s)},viewChanged:function(e){var t=e.changed;if("auto_close_success_message"in t){var i=this.$("#section-auto-close-success-message .sui-row");i.length&&("1"===t.auto_close_success_message?i.removeClass("sui-hidden"):i.addClass("sui-hidden"))}else if("automated_email"in t){var s=this.$("#hustle-automated-email-toggle-wrapper");s.length&&(t.automated_email?(s.removeClass("sui-hidden"),tinymce.EditorManager.execCommand("mceRemoveEditor",!0,"email_body"),tinymce.EditorManager.execCommand("mceAddEditor",!0,"email_body")):s.addClass("sui-hidden"))}"form_elements"in t&&this.updateDynamicValueFields()},addFields:function(){(new(Hustle.get("Modals.Optin_Fields"))).on("fields:added",e.proxy(this.addNewFields,this)),SUI.dialogs["hustle-dialog--optin-fields"].show()},maybeEditField:function(t){e(t.target).closest(".sui-dropdown").length||this.editField(t)},editField:function(t){var i=e(t.target).closest(".sui-builder-field").data("field-id"),s=this.model.get("form_elements")[i],n=Object.assign({},this.getFieldViewDefaults(s.type),s);new(Hustle.get("Modals.Edit_Field"))({field:s,fieldData:n,model:this.model}).on("field:updated",e.proxy(this.formFieldUpdated,this)),SUI.dialogs["hustle-dialog--edit-field"].show()},formFieldUpdated:function(e,t,i){if(Object.keys(t).length){if("name"in t)return this.addNewFields(e.type,e,i.name),void this.deleteField(i.name);var s=this.$("#hustle-optin-field--"+e.name);if("required"in t){var n=s.find(".sui-error"),a=e.required;_.isTrue(a)?n.show():_.isFalse(a)&&n.hide()}if("label"in t)this.updateDynamicValueFields(),s.find(".hustle-field-label-text").text(e.label)}},deleteFieldOnClick:function(t){var i=e(t.target).closest(".sui-builder-field").data("field-id");this.deleteField(i)},setFieldOption:function(t){var i=e(t.target),s=i.find("span:eq(1)").text();i.closest(".sui-insert-variables").find('input[type="text"]').val(s).trigger("change")},deleteField:function(t){var i=this.$("#hustle-optin-field--"+t),s=Object.assign({},this.model.get("form_elements"));delete s[t],this.model.set("form_elements",s),-1!==jQuery.inArray(t,["gdpr","recaptcha"])?(i.addClass("sui-hidden"),e("#hustle-optin-insert-field--"+t).prop("disabled",!1).prop("checked",!1)):i.remove()},duplicateField:function(t){var i=e(t.target).closest(".sui-builder-field").data("field-id"),s=Object.assign({},this.model.get("form_elements")),n=Object.assign({},s[i]);delete n.name,n.can_delete=!0,this.addNewFields(n.type,n)},addNewFields:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=Object.assign({},this.model.get("form_elements"));if(Array.isArray(e)){var n=!0,a=!1,o=void 0;try{for(var l,d=e[Symbol.iterator]();!(n=(l=d.next()).done);n=!0){var r=l.value,u=this.getFieldDefaults(r);t&&r in t&&_.extend(u,t[r]),this.addFieldToPanel(u),s[u.name]=u}}catch(e){a=!0,o=e}finally{try{n||null==d.return||d.return()}finally{if(a)throw o}}}else{var c=this.getFieldDefaults(e);if(t&&_.extend(c,t),this.addFieldToPanel(c,i),null===i)s[c.name]=c;else{var h=[];jQuery.each(s,function(e,t){h[e]=t,e===i&&(h[c.name]=c)}),s=h}}this.model.set("form_elements",s)},addFieldToDynamicValueFields:function(t){var i=e("<option/>",{value:t.name,"data-content":"{"+t.name+"}"}).text(t.label),s='<li><button value="{'.concat(t.name,'}">').concat(t.label,"</button></li>");this.$('select.hustle-field-options:not([data-type]), select.hustle-field-options[data-type="'+t.type+'"]').append(i),this.$(".hustle-fields-placeholders-options").length&&this.$(".hustle-fields-placeholders-options").append(s)},addFieldToPanel:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=Optin.template("hustle-form-field-row-tpl"),n=this.$("#hustle-form-fields-container");if(t=_.extend({},this.getFieldViewDefaults(t.type),t),-1!==jQuery.inArray(t.type,["gdpr","recaptcha"]))this.$("#hustle-optin-field--"+t.type).removeClass("sui-hidden"),e("#hustle-optin-insert-field--"+t.type).prop("checked",!0).prop("disabled",!0);else if(null===i)n.append(s(t));else{var a=this.$("#hustle-optin-field--"+i);0<a.length?a.after(s(t)):n.append(s(t))}},getNewFieldId:function(e){for(var t=Object.assign({},this.model.get("form_elements")),i=e;i in t&&-1===jQuery.inArray(i,["gdpr","recaptcha","submit"]);)i=e+"-"+Math.floor(99*Math.random());return i},getFieldDefaults:function(e){var t=this.getNewFieldId(e),i={label:optinVars.messages.form_fields.label[e+"_label"],required:"false",css_classes:"",type:e,name:t,placeholder:""};switch(e){case"timepicker":i.time_format="12",i.time_hours="9",i.time_minutes="30",i.time_period="am";break;case"datepicker":i.date_format="mm/dd/yy";break;case"recaptcha":i.recaptcha_type="compact",i.recaptcha_theme="light",i.recaptcha_language="automatic";break;case"gdpr":i.gdpr_message=optinVars.messages.form_fields.gdpr_message,i.required="true";break;case"email":case"url":i.validate="true"}return i},getFieldViewDefaults:function(e){var t={required:"false",validated:"false",placeholder_placeholder:optinVars.messages.form_fields.label.placeholder,label_placeholder:"",name_placeholder:"",icon:"send",css_classes:"",type:e,name:e,placeholder:optinVars.messages.form_fields.label[e+"_placeholder"],can_delete:!0,fieldId:this.getNewFieldId(e)};switch(e){case"email":t.icon="mail";break;case"name":t.icon="profile-male";break;case"phone":t.icon="phone";break;case"address":t.icon="pin";break;case"url":t.icon="web-globe-world";break;case"text":t.icon="style-type";break;case"number":t.icon="element-number";break;case"timepicker":t.icon="clock";break;case"datepicker":t.icon="calendar";break;case"recaptcha":t.icon="recaptcha";break;case"gdpr":t.icon="gdpr"}return t}})}),Hustle.define("Module.IntegrationsView",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{el:"#hustle-box-section-integrations",events:{"click .connect-integration":"connectIntegration","keypress .connect-integration":"preventEnterKeyFromDoingThings"},init:function(e){this.moduleId=e.moduleId,this.listenTo(Hustle.Events,"hustle:providers:reload",this.renderProvidersTables),this.render()},render:function(){var e=this.$el.find("#hustle-not-connected-providers-section"),t=this.$el.find("#hustle-connected-providers-section");0<e.length&&0<t.length&&this.renderProvidersTables()},renderProvidersTables:function(){var t=this,i={};this.$el.find(".hustle-integrations-display").html('<div class="sui-notice sui-notice-sm sui-notice-loading"><p>'+optinVars.fetching_list+"</p></div>"),i.action="hustle_provider_get_form_providers",i._ajax_nonce=optinVars.providers_action_nonce,i.data={moduleId:this.moduleId},e.post({url:ajaxurl,type:"post",data:i}).done(function(e){e&&e.success&&(t.$el.find("#hustle-not-connected-providers-section").html(e.data.not_connected),t.$el.find("#hustle-connected-providers-section").html(e.data.connected),t.$el.find("#hustle-integrations-active-integrations").val(e.data.list_connected).trigger("change"),t.$el.find("#hustle-integrations-active-count").val(e.data.list_connected_total).trigger("change"))}).always(function(){t.$el.find(".sui-box-body").removeClass("sui-block-content-center"),t.$el.find(".sui-notice-loading").remove()})},preventEnterKeyFromDoingThings:function(e){13!==e.which||e.preventDefault()},connectIntegration:function(e){Module.integrationsModal.open(e)}}))}),Hustle.define("Mixins.Module_Visibility",function(e,t,i){"use strict";return _.extend({},Hustle.get("Mixins.Model_Updater"),{el:"#hustle-conditions-group",targetContainer:e("#hustle-conditions-group"),events:{"click .hustle-choose-conditions":"openConditionsModal","click .hustle-remove-visibility-group":"removeGroup","change .visibility-group-filter-type":"updateGroupFilterType","change .visibility-group-apply-on":"updateGroupApplyOn"},init:function(e){this.activeConditions={},this.render(),this.groupId=""},render:function(){var t=this.model.get("conditions").toJSON();if(e.isEmptyObject(t))this.addNewGroup();else for(var i in t){var s=this.model.get("conditions."+i);s instanceof Backbone.Model||(_.isEmpty(s)&&_.isArray(s)&&(s={}),s=this.getConditionsGroupModel(s),this.model.set("conditions."+i,s,{silent:!0})),this.addGroupToPanel(s,"render")}},afterRender:function(){this.bindRemoveConditions()},bindRemoveConditions:function(){e("#hustle-conditions-group .hustle-remove-visibility-condition").off("click").on("click",e.proxy(this.removeCondition,this))},openConditionsModal:function(t){var i=this,s=e(t.currentTarget).data("group-id"),n=this.model.get("conditions."+s),a=void 0!==n?Object.keys(n.toJSON()):[];new(Hustle.get("Modals.Visibility_Conditions"))({groupId:s,conditions:a}).on("conditions:added",e.proxy(i.addNewConditions,i)),this.groupId=s,"done"!==e("html").data("show-was-bind")&&(SUI.dialogs["hustle-dialog--visibility-options"].on("show",function(t){e("#hustle-add-conditions").data("group_id",i.groupId)}),e("html").data("show-was-bind","done")),SUI.dialogs["hustle-dialog--visibility-options"].show()},addNewConditions:function(t){var i=this,s=t.groupId,n=t.conditions,a=this.model.get("conditions."+s);e.each(n,function(e,t){if(a.get(t))return!0;i.addConditionToPanel(t,{},s,a,"new")}),this.bindRemoveConditions(),Hustle.Events.trigger("view.rendered",this)},addGroupToPanel:function(t,i){var s=t.get("group_id"),n=e("#hustle-visibility-conditions-box"),a=Optin.template("hustle-visibility-group-box-tpl")(_.extend({},{groupId:s,apply_on_float:t.get("apply_on_float"),apply_on_inline:t.get("apply_on_inline"),apply_on_widget:t.get("apply_on_widget"),filter_type:t.get("filter_type")}));e(a).insertBefore(n.find(".hustle-add-new-visibility-group")),this.activeConditions[s]={};var o=this,l=t.toJSON();e.each(l,function(e,n){if("object"!==_typeof(n))return!0;o.addConditionToPanel(e,n,s,t,i)})},addConditionToPanel:function(t,i,s,n,a){if(void 0!==Optin.View.Conditions[t]){var o=this.$("#hustle-visibility-group-"+s+" .sui-box-builder-body"),l=new Optin.View.Conditions[t]({type:this.moduleType,model:n,groupId:s,source:a});if(l)return o.find(".sui-builder-field").length||(o.find(".sui-box-builder-message-block").hide(),o.find(".sui-button-dashed").show()),e.isEmptyObject(i)?n.set(t,l.getConfigs()):n.set(t,i),this.activeConditions[s][t]=l,e(l.$el).appendTo(o.find(".sui-builder-fields")),l}},addNewGroup:function(){var e=this.getConditionsGroupModel(),t=e.get("group_id");this.model.set("conditions."+t,e),this.addGroupToPanel(e,"new"),Hustle.Events.trigger("view.rendered",this)},removeGroup:function(t){var i=e(t.currentTarget).data("group-id"),s=this.$("#hustle-visibility-group-"+i);delete this.activeConditions[i],this.model.get("conditions").unset(i),s.remove(),Object.keys(this.activeConditions).length||this.addNewGroup()},removeCondition:function(t){var i=e(t.currentTarget),s=i.data("condition-id"),n=i.data("group-id"),a=this.$("#hustle-visibility-group-"+n+" .sui-box-builder-body"),o=this.activeConditions[n][s];o.off("change:update_label"),o.remove(),delete this.activeConditions[n][s],this.model.get("conditions."+n).unset(s),a.find(".sui-builder-field").length||a.find(".sui-box-builder-message-block").show(),this.bindRemoveConditions()},updateGroupFilterType:function(t){t.stopPropagation();var i=e(t.target),s=i.data("group-id"),n=i.val();this.model.get("conditions."+s).set("filter_type",n)},updateGroupApplyOn:function(t){t.stopPropagation();var i=e(t.target),s=i.data("group-id"),n=i.data("property"),a=i.is(":checked"),o=this.model.get("conditions."+s);("embedded"===this.moduleType&&-1!==e.inArray(n,["apply_on_inline","apply_on_widget"])||"social_sharing"===this.moduleType&&-1!==e.inArray(n,["apply_on_float","apply_on_inline","apply_on_widget"]))&&o.set(n,a)},getConditionsGroupModel:function(e){if(!e){var t=(new Date).getTime().toString(16);this.model.get("conditions."+t),e={group_id:t,filter_type:"all"},"embedded"===this.moduleType?(e.apply_on_inline=!0,e.apply_on_widget=!0):"social_sharing"===this.moduleType&&(e.apply_on_float=!0,e.apply_on_inline=!0,e.apply_on_widget=!0)}return new(Hustle.get("Model"))(e)}})}),Hustle.define("Mixins.Wizard_View",function(e,t,i){"use strict";return{moduleType:"",el:".sui-wrap",events:{"click .sui-sidenav .sui-vertical-tab a":"sidenav","click a.hustle-go-to-tab":"sidenav","click .hustle-action-save":"saveChanges","click .wpmudev-button-navigation":"doButtonNavigation","change #hustle-module-name":"updateModuleName","click #hustle-preview-module":"previewModule"},init:function(t){return this.setTabsViews(t),Hustle.Events.off("modules.view.switch_status",e.proxy(this.switchStatusTo,this)),Hustle.Events.on("modules.view.switch_status",e.proxy(this.switchStatusTo,this)),e(i).off("popstate",e.proxy(this.updateTabOnPopstate,this)),e(i).on("popstate",e.proxy(this.updateTabOnPopstate,this)),e(document).off("tinymce-editor-init",e.proxy(this.tinymceReady,this)),e(document).on("tinymce-editor-init",e.proxy(this.tinymceReady,this)),void 0!==this._events&&(this.events=e.extend(!0,{},this.events,this._events),this.delegateEvents()),this.render(),this},setTabsViews:function(e){this.contentView=e.contentView,this.emailsView=e.emailsView,this.designView=e.designView,this.integrationsView=e.integrationsView,this.visibilityView=e.visibilityView,this.settingsView=e.settingsView,this.moduleType=this.model.get("module_type"),"embedded"===this.moduleType&&(this.displayView=e.displayView)},render:function(){this.renderTabs(),Hustle.Events.trigger("modules.view.rendered",this)},renderTabs:function(){this.contentView.targetContainer.html(""),this.contentView.render(),this.contentView.delegateEvents(),this.contentView.targetContainer.append(this.contentView.$el),this.contentView.afterRender(),this.emailsView.targetContainer.html(""),this.emailsView.delegateEvents(),this.emailsView.targetContainer.append(this.emailsView.$el),this.emailsView.afterRender(),this.integrationsView.delegateEvents(),this.designView.targetContainer.html(""),this.designView.delegateEvents(),this.designView.targetContainer.append(this.designView.$el),this.designView.afterRender(),"embedded"===this.moduleType&&(this.displayView.targetContainer.html(""),this.displayView.render(),this.displayView.delegateEvents(),this.displayView.targetContainer.append(this.displayView.$el),this.displayView.afterRender()),this.visibilityView.delegateEvents(),this.visibilityView.targetContainer.append(this.visibilityView.$el),this.visibilityView.afterRender(),this.settingsView.targetContainer.html(""),this.settingsView.delegateEvents(),this.settingsView.targetContainer.append(this.settingsView.$el),this.settingsView.afterRender()},sidenav:function(t){t.preventDefault();var i=e(t.target).data("tab");i&&this.goToTab(i,!0)},goToTab:function(t,i){var s=this.$el.find('a[data-tab="'+t+'"]'),n=s.closest(".sui-vertical-tabs").find(".sui-vertical-tab a"),a=this.$el.find(".sui-box[data-tab]"),o=this.$el.find('.sui-box[data-tab="'+t+'"]');if(i){var l={tabName:t},d=this.model.get("module_id");history.pushState(l,"Hustle "+this.moduleType+" wizard","admin.php?page="+optinVars.current.wizard_page+"&id="+d+"&section="+t)}n.removeClass("current"),a.hide(),s.addClass("current"),o.show(),e(window).scrollTop(0)},updateTabOnPopstate:function(e){var t=e.originalEvent.state;t&&this.goToTab(t.tabName)},doButtonNavigation:function(t){t.preventDefault();var i=e(t.target),s="prev"===i.data("direction")?"prev":"next",n=i.closest(".sui-box").data("tab"),a=this.getNextOrPrevTabName(n,s);if("next"===s&&"behavior"===n)return window.location.replace("?page="+optinVars.current.listing_page);this.goToTab(a,!0)},getNextOrPrevTabName:function(e,t){var i="prev"===t?"prev":"next",s=this.model.get("moduleType"),n=this.model.get("module_mode");if("next"===i)switch(e){case"content":return"optin"===n?"emails":"appearance";case"emails":return"integrations";case"integrations":case"display":return"appearance";case"appearance":return"visibility";case"visibility":return"behavior";case"services":return"display"}else switch(e){case"emails":return"content";case"integrations":return"emails";case"appearance":return"social_sharing"===s?"display":"optin"===n?"integrations":"content";case"visibility":return"appearance";case"behavior":return"visibility";case"display":return"services"}return e},tinymceReady:function(t,i){var s=this;i.on("change",function(){Module.hasChanges||s.contentView.model.userHasChange()}),e("textarea#"+i.id).on("change",function(){Module.hasChanges||s.contentView.model.userHasChange()})},setContentFromTinymce:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if("undefined"!=typeof tinyMCE){var t=tinyMCE.get("main_content"),i=this.$("textarea#main_content"),s="true"===i.attr("aria-hidden")?t.getContent():i.val();this.contentView.model.set("main_content",s,{silent:e});var n=tinyMCE.get("success_message"),a=this.$("textarea#success_message"),o="true"===a.attr("aria-hidden")?n.getContent():a.val();this.emailsView.model.set("success_message",o,{silent:e});var l=tinyMCE.get("email_body"),d=this.$("textarea#email_body"),r="true"===a.attr("aria-hidden")?l.getContent():d.val();this.emailsView.model.set("email_body",r,{silent:e})}},sanitizeData:function(){var e=this.contentView.model.get("cta_url");/^(f|ht)tps?:\/\//i.test(e)||(e="https://"+e,this.contentView.model.set("cta_url",e,{silent:!0})),this.designView.updateCustomCss()},save:function(){this.setContentFromTinymce(!0),this.sanitizeData();var t=this,i=this.$el.find("#hustle-module-wizard-view"),s=i.data("id")?i.data("id"):"-1",n={action:"hustle_save_module",_ajax_nonce:i.data("nonce"),id:s,module:this.model.toJSON()};return _.extend(n,this.getDataToSave()),e.ajax({url:ajaxurl,type:"POST",data:n,complete:function(e){Module.hasChanges=!1,t.switchStatusTo("saved")}})},getDataToSave:function(){var e={content:this.contentView.model.toJSON(),emails:this.emailsView.model.toJSON(),design:this.designView.model.toJSON(),integrations_settings:this.integrationsView.model.toJSON(),visibility:this.visibilityView.model.toJSON(),settings:this.settingsView.model.toJSON()};return"embedded"===this.moduleType&&(e.display=this.displayView.model.toJSON()),e},saveChanges:function(t){var i=this,s=this.model.get("active"),n=void 0!==e(t.currentTarget).data("active")&&String(e(t.currentTarget).data("active")),a=!1;!1!==n&&("0"===n?this.disableButtonsOnSave("draft"):(this.disableButtonsOnSave("publish"),n!==s&&this.publishingFlow("loading")),n!==s&&(a=!0,this.model.set("active",n,{silent:!0})));var o=this.save();o?o.done(function(e){"string"==typeof e&&(e=JSON.parse(e)),e.success&&a&&i.updateViewOnActiveChange(),"0"!==n&&n!==s&&e.success&&a&&setTimeout(function(){i.publishingFlow("ready")},500)}).always(function(){i.enableSaveButtons()}):i.enableSaveButtons(),t.preventDefault()},updateModuleName:function(t){var i=e(t.target).val();i.length?(this.$("#hustle-module-name-wrapper").removeClass("sui-form-field-error"),this.$("#hustle-module-name-error").hide(),this.model.set("module_name",i)):(this.$("#hustle-module-name-wrapper").addClass("sui-form-field-error"),this.$("#hustle-module-name-error").show())},disableButtonsOnSave:function(e){"draft"===e?this.$("#hustle-draft-button").addClass("sui-button-onload"):"publish"===e&&this.$(".hustle-publish-button").addClass("sui-button-onload"),this.$(".hustle-action-save").prop("disabled",!0),this.$(".wpmudev-button-navigation").prop("disabled",!0)},enableSaveButtons:function(){this.$(".sui-button-onload").removeClass("sui-button-onload"),this.$(".hustle-action-save").prop("disabled",!1),this.$(".wpmudev-button-navigation").prop("disabled",!1)},switchStatusTo:function(e){"saved"===e?(this.$el.find("#hustle-unsaved-changes-status").addClass("sui-hidden"),this.$el.find("#hustle-saved-changes-status").removeClass("sui-hidden")):(this.$el.find("#hustle-unsaved-changes-status").removeClass("sui-hidden"),this.$el.find("#hustle-saved-changes-status").addClass("sui-hidden"))},updateViewOnActiveChange:function(){var e=this.model.get("active"),t="1"===e?optinVars.messages.commons.published:optinVars.messages.commons.draft,i="1"===e?optinVars.messages.commons.unpublish:optinVars.messages.commons.save_draft,s="1"===e?optinVars.messages.commons.save_changes:optinVars.messages.commons.publish;this.$el.find(".sui-status-module .sui-tag").text(t),this.$el.find("#hustle-draft-button .button-text").text(i),this.$el.find(".hustle-publish-button .button-text").text(s)},publishingFlow:function(t){var i=e("#hustle-dialog--publish-flow"),s=i.find(".sui-dialog-content > .sui-box"),n=i.find("#dialogIcon"),a=i.find("#dialogTitle"),o=i.find("#dialogDescription"),l=i.find(".sui-dialog-close"),d=i.find(".sui-dialog-overlay");function r(){n.removeClass("sui-icon-"+s.data("ready-icon")),n.addClass("sui-icon-"+s.data("loading-icon")),"loader"===s.attr("data-loading-icon")&&n.addClass("sui-loading"),a.text(s.data("loading-title")),o.text(s.data("loading-desc")),l.hide()}function u(){SUI.dialogs["hustle-dialog--publish-flow"].hide(),setTimeout(function(){r()},500)}"loading"===t&&(r(),SUI.dialogs["hustle-dialog--publish-flow"].show()),"ready"===t&&(n.removeClass("sui-icon-"+s.data("loading-icon")),n.addClass("sui-icon-"+s.data("ready-icon")),"loader"===s.attr("data-loading-icon")&&n.removeClass("sui-loading"),a.text(s.data("ready-title")),o.text(s.data("ready-desc")),l.show(),a.focus(),d.on("click",function(){u()}),l.on("click",function(){u()}))},previewModule:function(t){t.preventDefault(),this.setContentFromTinymce(!0),this.sanitizeData();var i=e(t.currentTarget),s=this.model.get("module_id"),n=this.model.get("module_type"),a=_.extend({},this.model.toJSON(),this.getDataToSave());i.addClass("sui-button-onload"),Module.preview.open(s,n,a)}}}),function(e){"use strict";var t;Optin.View.Conditions=Optin.View.Conditions||{},t=Hustle.View.extend({conditionId:"",className:"sui-builder-field sui-accordion-item sui-accordion-item--open",_template:Optin.template("hustle-visibility-rule-tpl"),template:!1,_defaults:{typeName:"",conditionName:"",header:"",label:""},_events:{"change input":"changeInput","change textarea":"changeInput","change select":"changeInput"},init:function(t){return this.undelegateEvents(),this.$el.removeData().unbind(),this.type=t.type,this.groupId=t.groupId,this.filter_type=t.filter_type,this.id=this.conditionId,this.template=void 0!==this.cpt?Optin.template("hustle-visibility-rule-tpl--post_type"):Optin.template("hustle-visibility-rule-tpl--"+this.conditionId),this._defaults={typeName:optinVars.messages.settings[this.type]?optinVars.messages.settings[this.type]:this.type,conditionName:optinVars.messages.conditions[this.conditionId]?optinVars.messages.conditions[this.conditionId]:this.conditionId,groupId:this.groupId,id:this.conditionId,source:t.source},this.data=this.getData(),this.render(),this.events=e.extend(!0,{},this.events,this._events),this.delegateEvents(),this.onInit&&_.isFunction(this.onInit)&&this.onInit.apply(this,arguments),this},getData:function(){return _.extend({},this._defaults,this.defaults(),this.model.get(this.conditionId),{type:this.type})},getTitle:function(){return this.title.replace("{type_name}",this.data.typeName)},getBody:function(){return"function"==typeof this.body?this.body.apply(this,arguments):this.body.replace("{type_name}",this.data.typeName)},getHeader:function(){return this.updateLabel(),this.trigger("change:update_label",this),this.header},updateLabel:function(){},countLines:function(e){return e.replace(/\s+$/g,"").split("\n").length},render:function(){var t=this._template(_.extend({},{title:this.getTitle(),body:this.getBody(),header:this.getHeader()},this._defaults,{type:this.type}));return this.$el.html(""),this.$el.html(t),e(".wph-conditions--box .wph-conditions--item:not(:last-child)").removeClass("wph-conditions--open").addClass("wph-conditions--closed"),e(".wph-conditions--box .wph-conditions--item:not(:last-child) section").hide(),this.rendered&&"function"==typeof this.rendered&&this.rendered.apply(this,arguments),this},updateAttribute:function(e,t){this.data=this.model.get(this.conditionId),this.data[e]=t,this.model.set(this.conditionId,this.data),this.model.trigger("change")},getAttribute:function(e){var t=this.model.get(this.conditionId);return!(!t||!t[e])&&t[e]},refreshLabel:function(){var e=this.getHeader();this.$el.find(".wph-condition--preview").html(""),this.$el.find(".sui-accordion-item-header .sui-tag").html(e)},changeInput:function(t){var i,s=t.target,n=s.getAttribute("data-attribute"),a=e(s),o=a.is(".sui-select")?a.val():t.target.value;return t.stopImmediatePropagation(),a.is(":checkbox")&&(o=a.is(":checked")),!a.is(".select2-search__field")&&(i=this.updateAttribute(n,o),this.refreshLabel(),i)},getConfigs:function(){return this.defaults()||!0}});var i=function(t){e(".wph-conditions--items").data("select2ScrollPosition",{})},s=function(t){var i=["all"];t.params&&t.params.args&&t.params.args.data&&t.params.args.data.id&&"all"===t.params.args.data.id||((i=e(this).val())&&-1!==i.indexOf("all")?i.splice(i.indexOf("all"),1):i=(i||[]).concat([t.params.args.data.id]),i&&i.length||(i=[t.params.args.data.id])),e(this).val(i).trigger("change")},n={events:{'change input[type="radio"]':"setCurrentLi"},setCurrentLi:function(t){var i=e(t.target),s=i.closest("li");s.siblings().removeClass("current"),s.toggleClass("current",i.is(":checked"))}};Optin.View.Conditions.posts=t.extend(_.extend({},n,{conditionId:"posts",title:optinVars.messages.conditions.posts,label:optinVars.messages.condition_labels.posts,defaults:function(){return{filter_type:"except",posts:[]}},onInit:function(){this.updateLabel()},getHeader:function(){return this.updateLabel(),this.trigger("change:update_label",this),_.contains(this.getAttribute("posts"),"all")?"only"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.all_posts:optinVars.messages.condition_labels.none:this.getAttribute("posts").length?("only"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.only_on_these_posts:optinVars.messages.condition_labels.except_these_posts).replace("{number}",this.getAttribute("posts").length):"only"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.none:optinVars.messages.condition_labels.all_posts},updateLabel:function(){this.getAttribute("posts").length&&!_.contains(this.getAttribute("posts"),"all")?this.label=("only"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.number_posts:optinVars.messages.condition_labels.except_these_posts).replace("{number}",this.getAttribute("posts").length?this.getAttribute("posts").length:0):_.contains(this.getAttribute("posts"),"all")?this.label="only"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.all_posts:optinVars.messages.condition_labels.no_posts:this.label="only"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.no_posts:optinVars.messages.condition_labels.all_posts},body:function(){return this.template(this.getData())},rendered:function(){this.$(".hustle-select-ajax").SUIselect2({tags:"true",width:"100%",dropdownCssClass:"sui-select-dropdown",ajax:{url:ajaxurl,delay:250,dataType:"json",type:"POST",data:function(e){return{action:"get_new_condition_ids",search:e.term,postType:"post"}},processResults:function(e){return{results:e.data}},cache:!0},createTag:function(){return!1}}).on("select2:selecting",s).on("select2:selecting",i).on("select2:unselecting",i)}})),Optin.View.Conditions.pages=t.extend(_.extend({},n,{conditionId:"pages",title:optinVars.messages.conditions.pages,label:optinVars.messages.condition_labels.pages,defaults:function(){return{filter_type:"except",pages:[]}},onInit:function(){this.updateLabel()},getHeader:function(){return this.updateLabel(),this.trigger("change:update_label",this),_.contains(this.getAttribute("pages"),"all")?"only"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.all_pages:optinVars.messages.condition_labels.none:this.getAttribute("pages").length?("only"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.only_on_these_pages:optinVars.messages.condition_labels.except_these_pages).replace("{number}",this.getAttribute("pages").length):"only"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.none:optinVars.messages.condition_labels.all_pages},updateLabel:function(){this.getAttribute("pages").length&&!_.contains(this.getAttribute("pages"),"all")?this.label=("only"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.number_pages:optinVars.messages.condition_labels.except_these_pages).replace("{number}",this.getAttribute("pages").length?this.getAttribute("pages").length:0):_.contains(this.getAttribute("pages"),"all")?this.label="only"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.all_pages:optinVars.messages.condition_labels.no_pages:this.label="only"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.no_pages:optinVars.messages.condition_labels.all_pages},body:function(){return this.template(this.getData())},rendered:function(){this.$(".hustle-select-ajax").SUIselect2({tags:"true",width:"100%",dropdownCssClass:"sui-select-dropdown",ajax:{url:ajaxurl,delay:250,dataType:"json",type:"POST",data:function(e){return{action:"get_new_condition_ids",search:e.term,postType:"page"}},processResults:function(e){return{results:e.data}},cache:!0},createTag:function(){return!1}}).on("select2:selecting",s).on("select2:selecting",i).on("select2:unselecting",i)}})),_.each(optinVars.post_types,function(e,a){e.label.toLowerCase();Optin.View.Conditions[e.name]=t.extend(_.extend({},n,{conditionId:e.name,title:e.label,label:optinVars.messages.condition_labels.posts,cpt:!0,defaults:function(){return{filter_type:"except",selected_cpts:[],postType:a,postTypeLabel:e.label}},updateLabel:function(){this.getAttribute("selected_cpts").length&&!_.contains(this.getAttribute("selected_cpts"),"all")?this.header=("only"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.only_these:optinVars.messages.condition_labels.except_these).replace("{number}",this.getAttribute("selected_cpts").length):_.contains(this.getAttribute("selected_cpts"),"all")?this.header="only"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.any:optinVars.messages.condition_labels.none:this.header="only"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.none:optinVars.messages.condition_labels.any},body:function(){return this.template(this.getData())},rendered:function(){this.$(".hustle-select-ajax").SUIselect2({tags:"true",width:"100%",dropdownCssClass:"sui-select-dropdown",ajax:{url:ajaxurl,delay:250,dataType:"json",type:"POST",data:function(e){return{action:"get_new_condition_ids",search:e.term,postType:a}},processResults:function(e){return{results:e.data}},cache:!0},createTag:function(){return!1}}).on("select2:selecting",s).on("select2:selecting",i).on("select2:unselecting",i)}}))}),Optin.View.Conditions.categories=t.extend(_.extend({},n,{conditionId:"categories",title:optinVars.messages.conditions.categories,label:optinVars.messages.condition_labels.categories,defaults:function(){return{filter_type:"except",categories:[]}},onInit:function(){this.updateLabel()},getHeader:function(){return this.updateLabel(),this.trigger("change:update_label",this),_.contains(this.getAttribute("categories"),"all")?"only"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.all_categories:optinVars.messages.condition_labels.none:this.getAttribute("categories").length?("only"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.only_on_these_categories:optinVars.messages.condition_labels.except_these_categories).replace("{number}",this.getAttribute("categories").length):"only"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.none:optinVars.messages.condition_labels.all_categories},updateLabel:function(){this.getAttribute("categories").length&&!_.contains(this.getAttribute("categories"),"all")?this.label=("only"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.number_categories:optinVars.messages.condition_labels.except_these_categories).replace("{number}",this.getAttribute("categories").length?this.getAttribute("categories").length:0):_.contains(this.getAttribute("categories"),"all")?this.label="only"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.all_categories:optinVars.messages.condition_labels.no_categories:this.label="only"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.no_categories:optinVars.messages.condition_labels.all_categories},body:function(){return this.template(this.getData())},rendered:function(){this.$(".hustle-select-ajax").SUIselect2({tags:"true",width:"100%",dropdownCssClass:"sui-select-dropdown",ajax:{url:ajaxurl,delay:250,dataType:"json",type:"POST",data:function(e){return{action:"get_new_condition_ids",search:e.term,postType:"category"}},processResults:function(e){return{results:e.data}},cache:!0},createTag:function(){return!1}}).on("select2:selecting",i).on("select2:unselecting",i)}})),Optin.View.Conditions.tags=t.extend(_.extend({},n,{conditionId:"tags",title:optinVars.messages.conditions.tags,label:optinVars.messages.condition_labels.tags,defaults:function(){return{filter_type:"except",tags:[]}},onInit:function(){this.updateLabel()},getHeader:function(){return this.updateLabel(),this.trigger("change:update_label",this),_.contains(this.getAttribute("tags"),"all")?"only"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.all_tags:optinVars.messages.condition_labels.none:this.getAttribute("tags").length?("only"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.only_on_these_tags:optinVars.messages.condition_labels.except_these_tags).replace("{number}",this.getAttribute("tags").length):"only"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.none:optinVars.messages.condition_labels.all_tags},updateLabel:function(){this.getAttribute("tags").length&&!_.contains(this.getAttribute("tags"),"all")?this.label=("only"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.number_tags:optinVars.messages.condition_labels.except_these_tags).replace("{number}",this.getAttribute("tags").length?this.getAttribute("tags").length:0):_.contains(this.getAttribute("tags"),"all")?this.label="only"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.all_tags:optinVars.messages.condition_labels.no_tags:this.label="only"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.no_tags:optinVars.messages.condition_labels.all_tags},body:function(){return this.template(this.getData())},rendered:function(){this.$(".hustle-select-ajax").SUIselect2({width:"100%",tags:"true",dropdownCssClass:"sui-select-dropdown",ajax:{url:ajaxurl,delay:250,dataType:"json",type:"POST",data:function(e){return{action:"get_new_condition_ids",search:e.term,postType:"tag"}},processResults:function(e){return{results:e.data}},cache:!0},createTag:function(){return!1}}).on("select2:selecting",i).on("select2:unselecting",i)}})),Optin.View.Conditions.only_on_not_found=t.extend({conditionId:"only_on_not_found",title:optinVars.messages.conditions.only_on_not_found,label:optinVars.messages.condition_labels.only_on_not_found,body:optinVars.messages.conditions_body.only_on_not_found}),Optin.View.Conditions.visitor_logged_in_status=t.extend({conditionId:"visitor_logged_in_status",title:optinVars.messages.conditions.visitor_logged_in,label:optinVars.messages.condition_labels.visitor_logged_in,defaults:function(){return{show_to:"logged_in"}},updateLabel:function(){this.getAttribute("show_to").length&&"logged_out"===this.getAttribute("show_to")?this.header=optinVars.messages.condition_labels.logged_out:this.header=optinVars.messages.condition_labels.logged_in},body:function(){return this.template(this.getData())}}),Optin.View.Conditions.shown_less_than=t.extend({conditionId:"shown_less_than",title:optinVars.messages.conditions.shown_less_than,label:optinVars.messages.condition_labels.shown_less_than,defaults:function(){return{less_than:""}},updateLabel:function(){0<this.getAttribute("less_than")?this.header=optinVars.messages.condition_labels.number_views.replace("{number}",this.getAttribute("less_than")):this.header=optinVars.messages.condition_labels.any},body:function(){return this.template(this.getData())}}),Optin.View.Conditions.visitor_device=t.extend({conditionId:"visitor_device",title:optinVars.messages.conditions.only_on_mobile,label:optinVars.messages.condition_labels.only_on_mobile,defaults:function(){return{filter_type:"mobile"}},updateLabel:function(){"not_mobile"===this.getAttribute("filter_type")?this.header=optinVars.messages.condition_labels.desktop_only:this.header=optinVars.messages.condition_labels.mobile_only},body:function(){return this.template(this.getData())}}),Optin.View.Conditions.from_referrer=t.extend({conditionId:"from_referrer",disable:["from_referrer"],title:optinVars.messages.conditions.from_specific_ref,label:optinVars.messages.condition_labels.from_specific_ref,defaults:function(){return{filter_type:"true",refs:""}},updateLabel:function(){var e=0;this.getAttribute("refs").length&&(e=this.countLines(this.getAttribute("refs"))),this.header=e?("false"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.except_these_refs:optinVars.messages.condition_labels.only_on_these_refs).replace("{number}",e):"false"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.any:optinVars.messages.condition_labels.none},body:function(){return this.template(this.getData())}}),Optin.View.Conditions.source_of_arrival=t.extend({conditionId:"source_of_arrival",title:optinVars.messages.conditions.from_search_engine,label:optinVars.messages.condition_labels.from_search_engine,defaults:function(){return{source_external:"false",source_search:"false"}},updateLabel:function(){var e=0;_.isTrue(this.getAttribute("source_external"))&&e++,_.isTrue(this.getAttribute("source_search"))&&e++,this.header=e?optinVars.messages.condition_labels.any_conditions.replace("{number}",e):optinVars.messages.condition_labels.any},body:function(){return this.template(this.getData())}}),Optin.View.Conditions.on_url=t.extend({conditionId:"on_url",title:optinVars.messages.conditions.on_specific_url,label:optinVars.messages.condition_labels.on_specific_url,defaults:function(){return{filter_type:"except",urls:""}},updateLabel:function(){var e=0;this.getAttribute("urls").length&&(e=this.countLines(this.getAttribute("urls"))),this.header=e?("only"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.only_on_these_urls:optinVars.messages.condition_labels.except_these_urls).replace("{number}",e):"only"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.none:optinVars.messages.condition_labels.all_urls},body:function(){return this.template(this.getData())}}),Optin.View.Conditions.visitor_commented=t.extend({conditionId:"visitor_commented",title:optinVars.messages.conditions.visitor_has_never_commented,label:optinVars.messages.condition_labels.visitor_has_never_commented,defaults:function(){return{filter_type:"true"}},updateLabel:function(){this.header="false"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.false:optinVars.messages.condition_labels.true},body:function(){return this.template(this.getData())}}),Optin.View.Conditions.visitor_country=t.extend({conditionId:"visitor_country",title:optinVars.messages.conditions.not_in_a_country,label:optinVars.messages.condition_labels.not_in_a_country,defaults:function(){return{countries:"",filter_type:"except"}},updateLabel:function(){this.getAttribute("countries").length?this.header=("only"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.only_on_these_countries:optinVars.messages.condition_labels.except_these_countries).replace("{number}",this.getAttribute("countries").length):this.header="only"===this.getAttribute("filter_type")?optinVars.messages.condition_labels.none:optinVars.messages.condition_labels.any},body:function(){return this.template(this.getData())},rendered:function(){this.$(".sui-select").val(this.getAttribute("countries")).SUIselect2().on("select2:selecting",i).on("select2:unselecting",i)}}),Optin.View.Conditions.page_404=t.extend({conditionId:"page_404",title:optinVars.messages.conditions.only_on_not_found,defaults:function(){return{show:"true"}},body:function(){return this.template(this.getData())},rendered:function(){this.$(".sui-tag").remove()}})}(jQuery),Hustle.define("Settings.Accessibility_Settings",function(e){"use strict";return Backbone.View.extend({el:"#accessibility-box",data:{},events:{"click .hustle-settings-save":"save"},initialize:function(){},save:function(t){var i=e(t.target),s={accessibility_color:e('input[name="hustle-accessibility-color"]',this.el).prop("checked")},n=i.data("nonce");return t.preventDefault(),i.prop("disabled",!0),i.addClass("sui-button-onload"),e.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"hustle_save_settings",target:"accessibility",data:s,_ajax_nonce:n},success:function(e){e.success?location.reload():(i.prop("disabled",!1),i.removeClass("sui-button-onload"),Module.Notification.open("error",optinVars.messages.something_went_wrong))},error:function(e){i.prop("disabled",!1),i.removeClass("sui-button-onload"),Module.Notification.open("error",optinVars.messages.something_went_wrong)}}),!1}})}),Hustle.define("Settings.Dashboard_Analytics_View",function(e,t,i){"use strict";return Backbone.View.extend({el:"#analytics-box",events:{"click .hustle-settings-save-analytics":"save"},initialize:function(){},save:function(t){var i=e(t.target),s=i.closest("form").data("nonce"),n={title:e("input[name=title]",this.el).val(),role:e("select[name=role]",this.el).val(),modules:[]};return t.preventDefault(),i.prop("disabled",!0),i.addClass("sui-button-onload"),_.isUndefined(i.data("enabled"))||(n.enabled=i.data("enabled")),e('input[name="modules[]"]',this.el).each(function(){e(this).is(":checked")&&n.modules.push(e(this).val())}),e.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"hustle_save_settings",target:"analytics",data:n,_ajax_nonce:s},success:function(e){i.prop("disabled",!1),i.removeClass("sui-button-onload"),e.success?e.data.reload?location.reload():Module.Notification.open("success",optinVars.messages.settings_saved):Module.Notification.open("error",optinVars.messages.something_went_wrong)},error:function(e){i.prop("disabled",!1),i.removeClass("sui-button-onload"),Module.Notification.open("error",optinVars.messages.something_went_wrong)}}),!1}})}),Hustle.define("Settings.Mail_View",function(e){"use strict";return Backbone.View.extend({el:"#emails-box",data:{},events:{"click .hustle-settings-save":"save","change input[type=text]":"changeValue","change input[type=email]":"changeValue"},initialize:function(){},changeValue:function(t){var i=e(t.currentTarget).val(),s=e(t.currentTarget).attr("name");this.data[s]=i},save:function(t){var i=e(t.target),s=i.data("nonce");if(t.preventDefault(),0!==this.data.length)return i.prop("disabled",!0),i.addClass("sui-button-onload"),e.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"hustle_save_settings",target:"emails",data:this.data,_ajax_nonce:s},success:function(e){i.prop("disabled",!1),i.removeClass("sui-button-onload"),e.success?Module.Notification.open("success",optinVars.messages.settings_saved):Module.Notification.open("error",optinVars.messages.something_went_wrong)},error:function(e){i.prop("disabled",!1),i.removeClass("sui-button-onload"),Module.Notification.open("error",optinVars.messages.something_went_wrong)}}),!1}})}),Hustle.define("Settings.Modules_Activity",function(e){"use strict";return Backbone.View.extend({el:"#wpmudev-settings-activity",events:{"change .hustle-for-admin-user-toggle":"toggleForUser","change .hustle-for-logged-in-user-toggle":"toggleForUser"},initialize:function(){},toggleForUser:function(t){var i=this.$(t.target),s=i.data("id"),n=i.data("nonce"),a=i.data("user");i.attr("disabled",!0),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_toggle_module_for_user",id:s,_ajax_nonce:n,user_type:a},complete:function(e,t){i.attr("disabled",!1)},success:function(e){e.success||i.prop("checked",!i.is(":checked"))},error:function(){i.prop("checked",!i.is(":checked"))}})}})}),Hustle.define("Settings.Permissions_View",function(e,t,i){"use strict";return Backbone.View.extend({el:"#permissions-box",data:{},events:{"click .hustle-settings-save":"save","change select":"changeValue"},initialize:function(){e(function(){function t(){e(".select2-selection__rendered li:first-child .select2-selection__choice__remove").off("click").text("").on("click",function(e){e.stopImmediatePropagation(),e.preventDefault()})}e("select").on("change.select2",function(e){t()}),t()})},changeValue:function(t){var i=e(t.currentTarget).val(),s=e(t.currentTarget).data("index");this.data[s]=i},save:function(t){var i=e(t.target),s=i.data("nonce");if(t.preventDefault(),0!==this.data.length)return i.prop("disabled",!0),i.addClass("sui-button-onload"),e.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"hustle_save_settings",target:"permissions",data:this.data,_ajax_nonce:s},success:function(e){i.prop("disabled",!1),i.removeClass("sui-button-onload"),e.success?Module.Notification.open("success",optinVars.messages.settings_saved):Module.Notification.open("error",optinVars.messages.something_went_wrong)},error:function(e){i.prop("disabled",!1),i.removeClass("sui-button-onload"),Module.Notification.open("error",optinVars.messages.something_went_wrong)}}),!1}})}),Hustle.define("Settings.Privacy_Settings",function(e){"use strict";return Backbone.View.extend({el:"#privacy-box",data:{},events:{"click #wph-gdpr-settings-submit":"removeIp","click .hustle-settings-save":"save"},initialize:function(){},removeIp:function(e){var t=this.$(e.target),i=this.$el.find("#wph-gdpr-settings"),s=this.$el.find("#wph-gdpr-settings-submit"),n=_.reduce(i.serializeArray(),function(e,t){return e[t.name]=t.value,e},{});e.preventDefault(),n.action="hustle_remove_ips",n._ajax_nonce=t.data("nonce"),s.prop("disabled",!0),s.addClass("wpmudev-button-onload"),this.$el.find(".wpmudev-loading").show(),this.processBatch(0,n,this,0)},processBatch:function(t,i,s,n){var a,o;i.offset=t,i.updated=n,e.post({url:ajaxurl,type:"post",data:i}).done(function(e){e&&e.success&&("done"===e.data.offset?(a=s.$el.find("#wph-gdpr-settings"),(o=s.$el.find("#wph-gdpr-settings-submit")).removeClass("wpmudev-button-onload"),s.$el.find(".wpmudev-loading").hide(),a.find("#hustle-delete-ip").val(""),a.append('<label class="wpmudev-label--success">'+e.data.updated+optinVars.messages.settings_rows_updated+"</label>"),setTimeout(function(){a.find(".wpmudev-label--success").remove(),o.prop("disabled",!1)},6e3)):s.processBatch(parseInt(e.data.offset),i,s,parseInt(e.data.updated)))})},save:function(t){var i=e(t.target),s={ip_tracking:e('input[name="hustle-ip-tracking"]:checked',this.el).val(),remove_all_ip:e('input[name="hustle-remove-all-ip"]:checked',this.el).val(),remove_ips:e('textarea[name="hustle-remove-ips"]',this.el).val()},n=i.data("nonce");return t.preventDefault(),i.prop("disabled",!0),i.addClass("sui-button-onload"),e.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"hustle_save_settings",target:"privacy",data:s,_ajax_nonce:n},success:function(e){i.prop("disabled",!1),i.removeClass("sui-button-onload"),e.success?Module.Notification.open("success",optinVars.messages.settings_saved):Module.Notification.open("error",optinVars.messages.something_went_wrong)},error:function(e){i.prop("disabled",!1),i.removeClass("sui-button-onload"),Module.Notification.open("error",optinVars.messages.something_went_wrong)}}),!1}})}),Hustle.define("Settings.reCaptcha_Settings",function(e){"use strict";return Backbone.View.extend({el:"#recaptcha-box",data:{},events:{"click .hustle-settings-save":"save"},initialize:function(){},save:function(t){var i=e(t.target),s={secret:e('input[name="hustle-recaptcha-secret-key"]',this.el).val(),language:e("#hustle-recaptcha-language",this.el).val(),sitekey:e('input[name="hustle-recaptcha-site-key"]',this.el).val()},n=i.data("nonce");return t.preventDefault(),i.prop("disabled",!0),i.addClass("sui-button-onload"),e.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"hustle_save_settings",target:"recaptcha",data:s,_ajax_nonce:n},success:function(e){if(i.prop("disabled",!1),i.removeClass("sui-button-onload"),e.success){var t=e.data.message;Module.Notification.open("success",t)}else Module.Notification.open("error",optinVars.messages.something_went_wrong)},error:function(e){i.prop("disabled",!1),i.removeClass("sui-button-onload"),Module.Notification.open("error",optinVars.messages.something_went_wrong)}}),!1}})}),Hustle.define("Settings.Top_Metrics_View",function(e,t,i){"use strict";return Backbone.View.extend({el:"#top-metrics-box",events:{"submit #top-metrics-form":"saveSettings","click #top-metrics-form .sui-checkbox input":"maybeDisableInputs"},initialize:function(){this.maybeDisableInputs()},saveSettings:function(t){var i=this.$(t.target),s=i.data("nonce"),n=i.serialize(),a=i.find('button[type="submit"]');t.preventDefault(),a.prop("disabled",!0),a.addClass("sui-button-onload"),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_save_settings",target:"top_metrics",data:n,_ajax_nonce:s},success:function(e){a.prop("disabled",!1),a.removeClass("sui-button-onload"),e.success?Module.Notification.open("success",optinVars.messages.settings_saved):Module.Notification.open("error",optinVars.messages.something_went_wrong)},error:function(e){a.prop("disabled",!1),a.removeClass("sui-button-onload"),Module.Notification.open("error",optinVars.messages.something_went_wrong)}})},maybeDisableInputs:function(){var e=this.$el.find("#top-metrics-form"),t=e.find("input:checked"),i=e.find("input:not(:checked)"),s=i.next("span");3<=t.length?(i.prop("disabled",!0),s.addClass("sui-tooltip"),s.css("opacity","1")):(i.prop("disabled",!1),s.removeClass("sui-tooltip"),s.css("opacity",""))}})}),Hustle.define("Settings.Unsubscribe_Settings",function(e){"use strict";return Backbone.View.extend({el:"#wpmudev-settings-unsubscribe",events:{"submit #wpmudev-settings-unsubscribe-messages":"saveUnsubscriptionMessages","submit #wpmudev-settings-unsubscribe-email":"saveUnsubscriptionEmail"},initialize:function(){},saveUnsubscriptionMessages:function(t){var i=this.$(t.target),s=i.data("nonce"),n=i.serialize();t.preventDefault(),i.find("button[type=submit]").addClass("wpmudev-button-onload"),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_save_unsubscribe_messages_settings",data:n,_ajax_nonce:s},success:function(e){e.success&&(i.append('<label class="wpmudev-label--success">'+optinVars.messages.settings_saved+"</label>"),i.find("button[type=submit]").removeClass("wpmudev-button-onload"),setTimeout(function(){i.find(".wpmudev-label--success").remove()},1e3))}})},saveUnsubscriptionEmail:function(t){var i=this.$(t.target),s=i.data("nonce"),n=i.serialize();t.preventDefault(),i.find("button[type=submit]").addClass("wpmudev-button-onload"),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_save_unsubscribe_email_settings",data:n,_ajax_nonce:s},success:function(e){e.success&&(i.append('<label class="wpmudev-label--success">'+optinVars.messages.settings_saved+"</label>"),i.find("button[type=submit]").removeClass("wpmudev-button-onload"),setTimeout(function(){i.find(".wpmudev-label--success").remove()},1e3))}})}})}),Hustle.define("Settings.Unsubscribe_View",function(e,t,i){"use strict";return Backbone.View.extend({el:"#unsubscribe-box",events:{"submit #unsubscribe-settings-form":"saveSettings"},initialize:function(){},saveSettings:function(t){var i=this.$(t.target),s=i.data("nonce"),n=i.serialize(),a=i.find('button[type="submit"]');t.preventDefault(),a.prop("disabled",!0),a.addClass("sui-button-onload"),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_save_settings",target:"unsubscribe",data:n,_ajax_nonce:s},success:function(e){a.prop("disabled",!1),a.removeClass("sui-button-onload"),e.success?Module.Notification.open("success",optinVars.messages.settings_saved):Module.Notification.open("error",optinVars.messages.something_went_wrong)},error:function(e){$button.prop("disabled",!1),$button.removeClass("sui-button-onload"),Module.Notification.open("error",optinVars.messages.something_went_wrong)}})}})}),function(e,t){"use strict";e(document).on("click",".wpoi-listing-wrap header.can-open .toggle, .wpoi-listing-wrap header.can-open .toggle-label",function(e){e.stopPropagation()}),e(".accordion header .optin-delete-optin, .accordion header .edit-optin, .wpoi-optin-details tr .button-edit").hide().css({transition:"none"}),e(document).on({mouseenter:function(){e(this).find(".optin-delete-optin, .edit-optin").stop().fadeIn("fast")},mouseleave:function(){var t=e(this);t.find(".toggle-checkbox").removeProp("disabled"),t.find(".edit-optin").removeProp("disabled"),t.removeClass("disabled"),t.find(".optin-delete-optin, .edit-optin, .delete-optin-confirmation").stop().fadeOut("fast")}},".accordion header"),e(document).on({mouseenter:function(){e(this).find(".button-edit").stop().fadeIn("fast")},mouseleave:function(){e(this).find(".button-edit").stop().fadeOut("fast")}},".wpoi-optin-details tr"),e(document).on("click",".wpoi-tabs-menu a",function(t){var i=e(this).attr("tab");t.preventDefault(),Optin.router.navigate(i,!0)}),e(document).on("click",".edit-optin",function(t){t.stopPropagation(),t.preventDefault(),window.location.href=e(this).attr("href")}),e(document).on("click",".wpoi-type-edit-button",function(t){var i=e(this).data("id"),s=e(this).data("type");t.preventDefault(),window.location.href="admin.php?page=inc_optin&optin="+i+"#display/"+s}),e(document).on("click","*[for]",function(t){var i=e(this),s=i.attr("for"),n=e("#"+s);!i.is("label")&&n.length&&(n.trigger("change"),n.trigger("click"))}),e("#wpoi-complete-message").fadeIn(),e(document).on("click","#wpoi-complete-message .next-button button",function(t){e("#wpoi-complete-message").fadeOut()}),e(document).on("click",".wpoi-listing-page .wpoi-listing-wrap header.can-open",function(t){e(this).find(".open").trigger("click")}),e(document).on("click",".wpoi-listing-page .wpoi-listing-wrap .can-open .open",function(t){var i=e(this).closest(".wpoi-listing-wrap"),s=i.find("section"),n=e(".wpoi-listing-wrap").not(i),a=e(".wpoi-listing-wrap section").not(s);t.stopPropagation(),a.slideUp(300,function(){a.removeClass("open")}),n.find(".dev-icon").removeClass("dev-icon-caret_up").addClass("dev-icon-caret_down"),s.slideToggle(300,function(){i.toggleClass("open"),i.find(".dev-icon").toggleClass("dev-icon-caret_up dev-icon-caret_down")})}),Optin.decorateNumberInputs=function(t){var i=t&&t.$el?t.$el.find(".wph-input--number input"):e(".wph-input--number input"),s=Hustle.createTemplate('<div class="wph-nbr--nav"><div class="wph-nbr--button wph-nbr--up {{disabled}}">+</div><div class="wph-nbr--button wph-nbr--down {{disabled}}">-</div></div>');i.each(function(){var t=e(this),i=t.is(":disabled")?"disabled":"";t.siblings(".wph-nbr--nav").length||t.after(s({disabled:i}))})},Hustle.Events.on("view.rendered",Optin.decorateNumberInputs),e(document).on("click",".wph-nbr--up:not(.disabled)",function(t){var i,s=e(this).closest(".wph-input--number").find("input"),n=parseFloat(s.val());s.attr("min"),(i=n>=s.attr("max")?n:n+1)!==n&&s.val(i).trigger("change")}),e(document).on("click",".wph-nbr--down:not(.disabled)",function(t){var i,s=e(this).closest(".wph-input--number").find("input"),n=parseFloat(s.val()),a=s.attr("min");s.attr("max"),(i=n<=a?n:n-1)!==n&&s.val(i).trigger("change")}),function(){function t(){var t=e(window).scrollTop(),i=e(".wph-sticky--anchor");i.length&&(t>(i=i.offset().top)?(e(".wph-preview--eye").addClass("wph-sticky--element"),e(".wph-sticky--anchor").height(e(".wph-preview--eye").outerHeight())):(e(".wph-preview--eye").removeClass("wph-sticky--element"),e(".wph-sticky--anchor").height(0)))}e(function(){e(window).scroll(t),t()})}()}(jQuery,document),Hustle.define("Integration_Modal_Handler",function(e){"use strict";return Backbone.View.extend({events:{"click .hustle-provider-connect":"connectAddOn","click .hustle-provider-disconnect":"disconnectAddOn","click .hustle-provider-next":"submitNextStep","click .hustle-provider-back":"goPrevStep","click .hustle-provider-load-more":"loadMore","click .hustle-provider-form-disconnect":"disconnectAddOnForm","click .hustle-provider-clear-radio-options":"clearRadioOptions","keypress .sui-dialog-content":"preventEnterKeyFromDoingThings"},preventEnterKeyFromDoingThings:function(e){13===e.which&&(e.preventDefault(),this.$(".hustle-provider-connect").length?this.$(".hustle-provider-connect").trigger("click"):this.$(".hustle-provider-next").length&&this.$(".hustle-provider-next").trigger("click"))},initialize:function(e){return this.slug=e.slug,this.nonce=e.nonce,this.action=e.action,this.moduleId=e.moduleId,this.multi_id=e.multiId,this.globalMultiId=e.globalMultiId,this.step=0,this.next_step=!1,this.prev_step=!1,this.render()},render:function(){var e={};e.action=this.action,e._ajax_nonce=this.nonce,e.data={},e.data.slug=this.slug,e.data.step=this.step,e.data.current_step=this.step,this.moduleId&&(e.data.module_id=this.moduleId),this.multi_id&&(e.data.multi_id=this.multi_id),this.globalMultiId&&(e.data.global_multi_id=this.globalMultiId),this.request(e,!1,!0)},request:function(t,i,s){var n=this;s&&(this.$el.find(".sui-box-body").addClass("sui-block-content-center").html('<p class="sui-loading-dialog" aria-label="Loading content"><i class="sui-icon-loader sui-loading" aria-hidden="true"></i></p>'),this.$el.find(".sui-box-footer").html(""),this.$el.find(".integration-header").html("")),this.$el.find(".sui-button:not(.disable-loader)").addClass("sui-button-onload"),this.ajax=e.post({url:ajaxurl,type:"post",data:t}).done(function(e){if(e&&e.success){n.renderBody(e),n.renderFooter(e);var t=e.data.data;if(n.onRender(t),n.$el.find(".sui-button").removeClass("sui-button-onload"),(i||!_.isUndefined(t.is_close)&&t.is_close)&&n.close(n),n.$el.find(".hustle-provider-close").on("click",function(){n.close(n)}),!_.isUndefined(t.notification)&&!_.isUndefined(t.notification.type)&&!_.isUndefined(t.notification.text))Module.Notification.open(t.notification.type,t.notification.text)}}),this.ajax.always(function(){n.$el.find(".sui-box-body").removeClass("sui-block-content-center"),n.$el.find(".sui-loading-dialog").remove()})},renderBody:function(t){this.$el.find(".sui-box-body").html(t.data.data.html);var i=this.$el.find(".sui-box-body .integration-header").remove();if(0<i.length&&this.$el.find(".integration-header").html(i.html()),e.trim(this.$el.find(".sui-box-body").html()).length){var s=this.$el.find(".sui-box-body").children(),n=!0;e.each(s,function(t,i){e(i).is(":hidden")||(n=!1)}),n?(this.$el.find(".sui-box-body").addClass("sui-hidden"),this.$el.find(".sui-box-footer").css("padding-top","")):this.$el.find(".sui-box-body select").each(function(){SUI.suiSelect(this)})}else this.$el.find(".sui-box-body").addClass("sui-hidden"),this.$el.find(".sui-box-footer").css("padding-top","")},renderFooter:function(e){var t=this,i=e.data.data.buttons,s=t.$el.find(".sui-box-body"),n=t.$el.find(".sui-box-footer");t.$el.find(".sui-box-footer").removeClass("sui-hidden").removeClass("sui-hidden-important").removeClass("sui-box-footer-center").removeClass("sui-box-footer-right").html(""),_.each(i,function(e){t.$el.find(".sui-box-footer").append(e.markup)}),0===n.find("button").length?n.addClass("sui-hidden-important"):(s.find(".hustle-installation-error").length&&n.addClass("sui-hidden-important"),1===n.find("button").length&&s.hasClass("sui-hidden")&&n.addClass("sui-box-footer-center"),1!==n.find("button").length||s.hasClass("sui-hidden")||n.addClass("sui-box-footer-right"))},onRender:function(e){this.delegateEvents(),_.isUndefined(e.opt_in_provider_current_step)||(this.step=+e.opt_in_provider_current_step),_.isUndefined(e.opt_in_provider_has_next_step)||(this.next_step=e.opt_in_provider_has_next_step),_.isUndefined(e.opt_in_provider_has_prev_step)||(this.prev_step=e.opt_in_provider_has_prev_step),this.$el.find("select").each(function(){SUI.suiSelect(this)}),this.$el.find(".sui-select").SUIselect2({dropdownCssClass:"sui-select-dropdown"})},submitNextStep:function(t){var i={},s=this.$el.find("form"),n={slug:this.slug,step:this.getStep(),current_step:this.step},a=s.serialize();this.moduleId&&(n.module_id=this.moduleId),a=a+"&"+e.param(n),i.action=this.action,i._ajax_nonce=this.nonce,i.data=a,this.request(i,!1,!1)},goPrevStep:function(e){var t={},i={slug:this.slug,step:this.getPrevStep(),current_step:this.step};this.moduleId&&(i.module_id=this.moduleId),this.multi_id&&(i.multi_id=this.multi_id),t.action=this.action,t._ajax_nonce=this.nonce,t.data=i,this.request(t,!1,!1)},loadMore:function(t){var i={},s={slug:this.slug,step:this.step,current_step:this.step};this.moduleId&&(s.module_id=this.moduleId),this.multi_id&&(s.multi_id=this.multi_id),s.page=e(t.target).data("page"),i.action=this.action,i._ajax_nonce=this.nonce,i.data=s,this.request(i,!1,!1),t.preventDefault()},getStep:function(){return this.next_step?this.step+1:this.step},getPrevStep:function(){return this.prev_step?this.step-1:this.step},connectAddOn:function(){var t={},i=this.$el.find("form"),s={slug:this.slug,step:this.getStep(),current_step:this.step},n=i.serialize();this.moduleId&&(s.module_id=this.moduleId),this.multi_id&&(s.multi_id=this.multi_id),n=n+"&"+e.param(s),t.action=this.action,t._ajax_nonce=this.nonce,t.data=n,this.request(t,!1,!1)},disconnectAddOn:function(t){var i=this,s=this.$el.find(".sui-dialog-image img").attr("src"),n=this.$el.find("#dialogTitle2").html(),a={},o={},l={};e("hustle-dialog--remove-active-warning").val();a.action="hustle_provider_deactivate",a._ajax_nonce=this.nonce,a.data={},a.data.slug=this.slug,a.data.img=s,a.data.title=n,this.globalMultiId&&(a.data.global_multi_id=this.globalMultiId),o.action="hustle_provider_is_on_module",o._ajax_nonce=this.nonce,o.data={},o.data.slug=this.slug,o.data.globalMultiId=this.globalMultiId,this.$el.find(".sui-button:not(.disable-loader)").addClass("sui-button-onload"),e.ajax({url:ajaxurl,type:"POST",data:o,success:function(e){!0===e.success&&(l=e)},complete:function(){!0===l.success?Module.integrationsActiveRemove.open(l.data,a,i):i.request(a,!0,!1)}})},disconnectAddOnForm:function(t){var i={},s=e("#hustle-integrations-active-count").val(),n=e("#hustle-integrations-active-integrations").val();i.action="hustle_provider_form_deactivate",i._ajax_nonce=this.nonce,i.data={},i.data.slug=this.slug,i.data.module_id=this.moduleId,this.multi_id&&(i.data.multi_id=this.multi_id),1==s&&n===this.slug&&"local_list"!==this.slug?Module.integrationsAllRemove.open(i,this):1==s&&"local_list"===this.slug?Module.Notification.open("error",optinVars.messages.integraiton_required):this.request(i,!0,!1)},close:function(t){t.ajax.abort(),t.remove(),e("body").css("overflow","auto"),Hustle.Events.trigger("hustle:providers:reload")},clearRadioOptions:function(){this.$("input[type=radio]",this.$el).removeAttr("checked")}})});var Module=window.Module||{};Hustle.define("Model",function(e){"use strict";return Backbone.Model.extend({initialize:function(){this.on("change",this.userHasChange,this),Backbone.Model.prototype.initialize.apply(this,arguments)},userHasChange:function(){Module.hasChanges=!0,Hustle.Events.trigger("modules.view.switch_status","unsaved")}})}),Hustle.define("Models.M",function(){"use strict";return Hustle.get("Model").extend({toJSON:function(){var e,t=_.clone(this.attributes);for(e in t)(t[e]instanceof Backbone.Model||t[e]instanceof Backbone.Collection)&&(t[e]=t[e].toJSON());return t},set:function(e,t,i){var s,n,a;"string"==typeof e&&-1!==e.indexOf(".")?(s=e.split(".")[0],n=e.split(".")[1],(a=this.get(s))&&a instanceof Backbone.Model&&(a.set(n,t,i),this.trigger("change:"+e,e,t,i),this.trigger("change:"+s,e,t,i))):Backbone.Model.prototype.set.call(this,e,t,i)},get:function(e){var t,i;return"string"==typeof e&&-1!==e.indexOf(".")?(t=e.split(".")[0],i=e.split(".")[1],this.get(t).get(i)):Backbone.Model.prototype.get.call(this,e)}})}),Hustle.define("Models.Trigger",function(){"use strict";return Hustle.get("Model").extend({defaults:{trigger:"time",on_time_delay:0,on_time_unit:"seconds",on_scroll:"scrolled",on_scroll_page_percent:"20",on_scroll_css_selector:"",enable_on_click_element:"1",on_click_element:"",enable_on_click_shortcode:"1",on_exit_intent:"1",on_exit_intent_per_session:"1",on_exit_intent_delayed:"0",on_exit_intent_delayed_time:5,on_exit_intent_delayed_unit:"seconds",on_adblock:"0"}})}),Module.Model=Hustle.get("Models.M").extend({defaults:{module_name:"",moduleType:"popup",active:"0"}}),Hustle.define("Models.Module_Defaults",function(e,t,i){"use strict";return{visibilityDefaults:{defaults:{conditions:""},initialize:function(e){if(_.extend(this,e),!(this.get("conditions")instanceof Backbone.Model)){_.isEmpty(this.get("conditions"))&&_.isArray(this.get("conditions"))&&(this.conditions={});var t=Hustle.get("Model");this.set("conditions",new t(this.conditions))}this.on("change",this.userHasChange,this)}},settingsDefaults:{defaults:{},initialize:function(e){_.extend(this,e);var t=Hustle.get("Models.Trigger");this.get("triggers")instanceof Backbone.Model||this.set("triggers",new t(this.triggers)),this.on("change",this.userHasChange,this)}}}}),function(e){"use strict";var t=window.Module||{};t.Notification={$notification:{},_deferred:{},initialize:function(){e("#hustle-notification").length?(e("#hustle-notification").remove(),this.initialize()):e('<div id="hustle-notification" class="sui-notice-top sui-notice-'+this.type+' sui-can-dismiss d-none"><div class="sui-notice-content"><p>'+this.text+'</p></div><span class="sui-notice-dismiss"><a role="button" href="#" aria-label="'+optinVars.messages.commons.dismiss+'" class="sui-icon-check"></a></span></div>').css({display:"none"}).appendTo(e("main.sui-wrap")).slideDown(),this.$notification=e("#hustle-notification")},open:function(t,i,s){var n=this;return _.isUndefined(s)&&(s=4e3),void 0!==n.closeTimeout&&(window.clearTimeout(n.closeTimeout),delete n.closeTimeout,n.close()),this.type=t||"notice",this.text=i,this.initialize(),e(".sui-notice-dismiss a").click(function(e){return e.preventDefault(),n.close(),!1}),s&&(this.closeTimeout=setTimeout(function(){n.close()},s)),this._deferred=new e.Deferred,this._deferred.promise()},close:function(t){var i=e("#hustle-notification");i.stop().slideUp("slow"),this._deferred.resolve(i,t)}},t.integrationsModal={$popup:{},_deferred:{},open:function(t){var i=this,s=e(t.target);e("#hustle-integration-popup").remove(),s.hasClass("connect-integration")||(s=s.closest(".connect-integration"));var n=function(){return i.close(),!1},a=s.data("nonce"),o=s.data("slug"),l=s.data("title"),d=s.data("image"),r=s.data("action"),u=s.data("module_id"),c=s.data("multi_id"),h=s.data("global_multi_id"),p=Optin.template("hustle-integration-dialog-tpl");return e("main.sui-wrap").append(p({image:d,title:l})),this.$popup=e("#hustle-integration-dialog"),new(Hustle.get("Integration_Modal_Handler"))({slug:o,nonce:a,action:r,moduleId:u,multiId:c,globalMultiId:h,el:this.$popup}).on("modal:closed",function(){return i.close()}),this.$popup.find(".hustle-popup-action").remove(),this.$popup.find(".sui-dialog-close").on("click",n),this.$popup.find(".sui-dialog-overlay").on("click",n),this.$popup.on("click",".hustle-popup-cancel",n),this.$popup.find(".sui-dialog-overlay").on("click",function(){e(this).parent("#hustle-integration-dialog").find(".sui-dialog-close").trigger("click")}),this.$popup.find(".sui-dialog-overlay").removeClass("sui-fade-out").addClass("sui-fade-in"),this.$popup.find(".sui-dialog-content").removeClass("sui-bounce-out").addClass("sui-bounce-in"),this.$popup.removeAttr("aria-hidden"),e("body").css("overflow","hidden"),this._deferred=new e.Deferred,this._deferred.promise()},close:function(t){var i=e("#hustle-integration-popup");i.find(".sui-dialog-overlay").removeClass("sui-fade-in").addClass("sui-fade-out"),i.find(".sui-dialog-content").removeClass("sui-bounce-in").addClass("sui-bounce-out"),e("body").css("overflow","auto"),setTimeout(function(){i.attr("aria-hidden","true")},300),this._deferred.resolve(this.$popup,t)}},t.integrationsAllRemove={$popup:{},_deferred:{},open:function(t,i){var s=this,n=e("#hustle-dialog--final-delete"),a=function(){return s.close(),!1};n.find(".sui-dialog-close").on("click",a),n.find(".sui-dialog-overlay").on("click",a),n.find("#hustle-delete-final-button-cancel").on("click",a),e("#hustle-delete-final-button").off("click").on("click",function(n){e("#hustle-delete-final-button").addClass("sui-button-onload"),function(e,t){s.deleteIntegration(e,t)}(t,i),function(e){s.insertLocalList(e)}(t),a()}),e("#hustle-integration-dialog").addClass("sui-fade-out").hide(),e("#hustle-delete-final-button").removeAttr("disabled"),SUI.dialogs["hustle-dialog--final-delete"].show()},close:function(){var t=e("#hustle-dialog--final-delete");t.find(".sui-dialog-overlay").removeClass("sui-fade-in").addClass("sui-fade-out"),t.find(".sui-dialog-content").removeClass("sui-bounce-in").addClass("sui-bounce-out"),e("#hustle-delete-final-button").removeClass("sui-button-onload"),e("#hustle-integration-dialog").remove(),e("body").css("overflow","auto"),e("#hustle-delete-final-button").attr("disabled"),setTimeout(function(){t.attr("aria-hidden","true")},300),SUI.dialogs["hustle-dialog--final-delete"].hide()},confirmDelete:function(e,t){this.deleteIntegration(e,t),this.insertLocal(e),this.close()},deleteIntegration:function(e,t){t.request(e,!0,!1)},insertLocalList:function(i){var s={id:i.data.module_id,_ajax_nonce:i._ajax_nonce,action:"hustle_provider_insert_local_list"};e.ajax({url:ajaxurl,type:"POST",data:s,success:function(e){if(e.success)Hustle.Events.trigger("hustle:providers:reload");else{if(void 0===SUI.dialogs["hustle-dialog--final-delete"])return void t.Notification.open("error",optinVars.messages.something_went_wrong);SUI.dialogs["hustle-dialog--final-delete"].hide()}},error:function(){t.Notification.open("error",optinVars.messages.something_went_wrong),SUI.dialogs["hustle-dialog--final-delete"].hide()}})}},t.integrationsActiveRemove={$popup:{},_deferred:{},open:function(t,i,s){var n=this,a=e("#hustle-dialog--remove-active"),o=function(){return n.close(),!1},l=Optin.template("hustle-modules-active-integration-tpl"),d=Optin.template("hustle-modules-active-integration-img-tpl"),r=Optin.template("hustle-modules-active-integration-header-tpl"),u=Optin.template("hustle-modules-active-integration-desc-tpl");e("#hustle-dialog--remove-active tbody").html(""),e("#hustle-dialog--remove-active .sui-dialog-image").html(""),e("#hustle-dialog--remove-active #sui-box-modal-header").html(""),e("#hustle-dialog--remove-active #sui-box-modal-content").html(""),e("#hustle-dialog--remove-active .sui-dialog-image").append(d({image:i.data.img,title:i.data.slug})),e("#hustle-dialog--remove-active #sui-box-modal-header").append(r({title:i.data.title.replace(/Connect|Configure/gi," ")})),e("#hustle-dialog--remove-active #sui-box-modal-content").append(u({title:i.data.title.replace(/Connect|Configure/gi," ")})),e.each(t,function(t,i){e("#hustle-dialog--remove-active tbody").append(l({name:i.name,type:i.type,editUrl:i.edit_url}))}),a.find(".sui-dialog-close").on("click",o),a.find(".sui-dialog-overlay").on("click",o),a.find("#hustle-remove-active-button-cancel").on("click",o),a.find(".hustle-remove-active-integration-back").on("click",function(){n.back(s)}),e("#hustle-remove-active-button").off("click").on("click",function(a){e(this).addClass("sui-button-onload"),function(e,t,i){n.removeIntegration(e,t,i),o()}(i,s,t)}),e("#hustle-integration-dialog").addClass("sui-fade-out").hide(),SUI.dialogs["hustle-dialog--remove-active"].show()},close:function(){var t=e("#hustle-dialog--remove-active");t.find(".sui-dialog-overlay").removeClass("sui-fade-in").addClass("sui-fade-out"),t.find(".sui-dialog-content").removeClass("sui-bounce-in").addClass("sui-bounce-out"),e("#hustle-delete-final-button").removeClass("sui-button-onload"),e("#hustle-integration-dialog").remove(),e("body").css("overflow","auto"),setTimeout(function(){t.attr("aria-hidden","true")},300),SUI.dialogs["hustle-dialog--remove-active"].hide()},back:function(t){this.close(),"hubspot"===t.slug||"constantcontact"===t.slug?e('button[data-slug="'+t.slug+'"]').trigger("click"):e('button[data-global_multi_id="'+t.globalMultiId+'"]').trigger("click")},removeIntegration:function(t,i,s){var n=this;e.each(s,function(e,i){t.data.slug===i.active.active_integrations&&n.insertLocalList(t,e)}),i.request(t,!0,!1),e("#hustle-remove-active-button").removeClass("sui-button-onload")},insertLocalList:function(i,s){var n={id:s,_ajax_nonce:i._ajax_nonce,action:"hustle_provider_insert_local_list"};e.ajax({url:ajaxurl,type:"POST",data:n,success:function(e){!1!==e.success||t.Notification.open("error",optinVars.messages.something_went_wrong)},error:function(){t.Notification.open("error",optinVars.messages.something_went_wrong)}})}},t.deleteModal={open:function(i){var s=Optin.template("hustle-dialog--delete-tpl")(i),n=Optin.template("hustle-dialog--delete-title-tpl")(i),a=Optin.template("hustle-dialog--delete-description-tpl")(i),o="hustle-dialog--delete";if(e("#hustle-dialog--delete-form").html(s),e("#"+o+" #dialogTitle").html(n),e("#"+o+" #dialogDescription").html(a),void 0===SUI.dialogs[o])return t.Notification.open("error",optinVars.messages.something_went_wrong),!1;e("#"+o+" .hustle-delete-confirm").off("click").on("click",function(t){e(t.currentTarget).addClass("sui-button-onload")}),SUI.dialogs[o].show()}},t.resetTrackingDataModal={open:function(i){var s="hustle-dialog--tracking-reset-data";if(void 0===SUI.dialogs[s])return t.Notification.open("error",optinVars.messages.something_went_wrong),!1;SUI.dialogs[s].show();var n=e("#"+s);e(".hustle-delete",n).data("module_id",i.id).data("nonce",i.nonce)},reset:function(i){var s=e(i.target),n=s.data("dialogId");s.addClass("sui-button-onload");var a={id:s.data("module_id"),_ajax_nonce:s.data("nonce"),action:"hustle_module_tracking_reset"};e.ajax({url:ajaxurl,type:"POST",data:a,success:function(e){if(e.success)location.reload();else{if(s.removeClass("sui-button-onload"),void 0===SUI.dialogs[n])return void t.Notification.open("error",optinVars.messages.something_went_wrong);SUI.dialogs[n].hide()}},error:function(){s.removeClass("sui-button-onload"),t.Notification.open("error",optinVars.messages.something_went_wrong)}})}},t.preview={open:function(t,i){var s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this,a="embedded"===i||"social_sharing"===i;e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_preview_module",id:t,previewData:s}}).then(function(i){if(i.success){var s="";a?s=e("#hustle-dialog--preview .sui-box-body"):(s=e("#module-preview-container")).length||(e("main.sui-wrap").append('<div id="module-preview-container"></div>'),s=e("#module-preview-container")),s.html(i.data.html);var o=s.find(".hustle-ui");n.maybeRenderRecaptcha(o,i),o.find(".hustle-select2").length&&HUI.select2(),o.find(".hustle-time").length&&HUI.timepicker(".hustle-time"),o.find(".hustle-date").length&&HUI.datepicker(".hustle-date"),HUI.nonSharingSimulation(o),HUI.inputFilled(),i.data.style&&s.append(i.data.style),i.data.script&&s.append(i.data.script)}return{id:t,data:i.data.module}},function(e){console.log(e)}).then(function(e){var t=e.id,i=e.data;t&&(a&&SUI.dialogs["hustle-dialog--preview"].show(),n.showModule(t,i))}).always(function(){e(".sui-button-onload").removeClass("sui-button-onload")})},showModule:function(t,i){var s=".hustle_module_id_"+t;if("popup"===i.module_type){var n="0"!==String(e(s).data("close-delay"))&&e(s).data("close-delay");HUI.popupLoad(s,n)}else if("slidein"===i.module_type){var a="0"!==String(e(s).data("close-delay"))&&e(s).data("close-delay");HUI.slideinBoxShadow(s),HUI.slideinLoad(s,a),e(window).on("resize",function(){HUI.slideinBoxShadow(s)})}else HUI.inlineResize(s),HUI.inlineLoad(s)},maybeRenderRecaptcha:function(e,t){if(void 0!==t.data&&void 0!==t.data.module&&void 0!==t.data.module.module_mode&&void 0!==t.data.module.emails&&void 0!==t.data.module.emails.form_elements&&void 0!==t.data.module.emails.form_elements.recaptcha&&"optin"===t.data.module.module_mode&&void 0!==t.data.recaptcha&&void 0!==t.data.recaptcha.sitekey&&""!==t.data.recaptcha.sitekey){var i=t.data.module,s="hustle-modal-recaptcha-"+i.module_id,n=void 0!==i.emails.form_elements.recaptcha.recaptcha_type?i.emails.form_elements.recaptcha.recaptcha_type:"normal",a=void 0!==i.emails.form_elements.recaptcha.recaptcha_theme?i.emails.form_elements.recaptcha.recaptcha_theme:"dark";e.find(".hustle-recaptcha").attr("id",s),e.find(".hustle-modal-body button").prop("disabled",!0),grecaptcha.ready(function(){var i={sitekey:t.data.recaptcha.sitekey,theme:a,size:n};"invisible"===n?(i.badge="inline",i.callback=function(t){e.trigger("submit.frontSubmit")}):i.callback=function(){e.find(".hustle-layout-body button").removeProp("disabled")};var o=grecaptcha.render(s,i);e.find(".hustle-recaptcha").attr("recaptcha-id",o)})}}},t.hasChanges=!1,window.onbeforeunload=function(){if(t.hasChanges)return optinVars.messages.dont_navigate_away},e(".highlight_input_text").focus(function(){e(this).select()})}(jQuery),function(e){"use strict";(window.Module||{}).Utils={getUrlParam:function(e){var t,i,s=window.location.search.substring(1).split("&");for(i=0;i<s.length;i++)if((t=s[i].split("="))[0]===e)return t[1];return!1}}}(jQuery),Hustle.define("SShare.Content_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Module_Content"),{activePlatforms:[],events:{"click ul.wpmudev-tabs-menu li label":"toggleCheckbox","change .wpmudev-social-item input.wpmudev-social-item-native-enable":"toggleIcon","change .wpmudev-social-custom .wpmudev-social-item input.toggle-checkbox":"toggleIcon","click .hustle-choose-platforms":"openPlatformsModal"},render:function(t){if(this.targetContainer.length){var i=this,s=this.model.toJSON();if(this.setElement(this.template(_.extend({module_type:i.moduleType},s))),void 0!==s.social_icons&&s.social_icons)for(var n in s.social_icons)i.addPlatformToPanel(n,s.social_icons[n]);var a=this.$("#hustle-social-services").sortable({axis:"y",containment:".sui-box-builder"});for(var o in a.on("sortupdate",e.proxy(i.platformsOrderChanged,i,a)),optinVars.social_platforms)i.addPlatformToDialog(o);return this}},afterRender:function(){this.bindRemoveService(),optinVars.is_new&&Module.Notification.open("success",optinVars.messages.commons.module_created.replace(/{type_name}/g,optinVars.module_name[this.moduleType]),1e4)},bindRemoveService:function(){e("#hustle-wizard-content .hustle-remove-social-service").off("click").on("click",e.proxy(this.removeService,this))},openPlatformsModal:function(t){var i=this.model.get("social_icons"),s=void 0!==i?Object.keys(i):[];new(Hustle.get("Modals.Services_Platforms"))(s).on("platforms:added",e.proxy(this.addNewPlatforms,this)),SUI.dialogs["hustle-dialog--add-platforms"].show()},addNewPlatforms:function(t){var i=this;this.model.get("social_icons")||this.model.set("social_icons",{});var s=this,n=_.extend({},this.model.get("social_icons"));e.each(t,function(e,t){if(n&&t in n)return!0;s.addPlatformToPanel(t,{});var a=i.getPlatformDefaults(t);n[t]=a}),this.bindRemoveService(),this.model.set("social_icons",n),Hustle.Events.trigger("view.rendered",this)},addPlatformToPanel:function(e,t){var i=Optin.template("hustle-platform-row-tpl"),s=this.$("#hustle-social-services");t=_.extend({},this.getPlatformViewDefaults(e),t),this.activePlatforms.push(e),s.append(i(t))},addPlatformToDialog:function(t){var i=Optin.template("hustle-add-platform-li-tpl"),s=e("#hustle_add_platforms_container"),n=this.getPlatformViewDefaults(t);s.append(i(n))},getPlatformDefaults:function(e){return{platform:e,label:e in optinVars.social_platforms?optinVars.social_platforms[e]:e,type:"click",counter:"0",link:""}},getPlatformViewDefaults:function(e){var t=this.model.toJSON(),i=void 0===t.counter_enabled?"true":t.counter_enabled,s={fivehundredpx:"500px"},n=-1!==optinVars.social_platforms_with_endpoints.indexOf(e),a=-1!==optinVars.social_platforms_with_api.indexOf(e),o=e in s?s[e]:e;return _.extend({},this.getPlatformDefaults(e),{platform_style:o,counter_enabled:i,hasEndpoint:n,hasCounter:a})},platformsOrderChanged:function(e){var t=this.model.get("social_icons"),i=e.sortable("toArray",{attribute:"data-platform"}),s={},n=!0,a=!1,o=void 0;try{for(var l,d=i[Symbol.iterator]();!(n=(l=d.next()).done);n=!0){var r=l.value;s[r]=t[r]}}catch(e){a=!0,o=e}finally{try{n||null==d.return||d.return()}finally{if(a)throw o}}this.model.set("social_icons",s),this.model.trigger("change",this.model)},removeService:function(t){var i=e(t.currentTarget).data("platform"),s=this.model.get("social_icons");this.$("#hustle-platform-"+i).remove(),this.activePlatforms=_.without(this.activePlatforms,i),delete s[i],this.model.trigger("change",this.model),t.stopPropagation()},modelUpdated:function(t){var i,s=t.changed,n=void 0!==Object.keys(s)[0]?Object.keys(s)[0]:"";if("service_type"in s&&this.serviceTypeUpdated(s.service_type),"counter_enabled"in s){var a=this.$("#hustle-social-services");s.counter_enabled?a.find("div.sui-form-field:nth-child(1),div.sui-form-field:nth-child(2)").each(function(){e(this).removeClass("sui-hidden")}):a.find("div.sui-form-field:nth-child(1),div.sui-form-field:nth-child(2)").each(function(){e(this).addClass("sui-hidden")}),Hustle.Events.trigger("modules.view.counterEnabledUpdated",this.model)}if("click_counter"in s)this.clickCounterUpdated(s.click_counter);else if(-1!==n.indexOf("_counter")){var o=n.slice(0,-8);o in(i=this.model.get("social_icons"))&&(i[o].counter=parseInt(s[n])),this.model.unset(n,{silent:!0})}if(-1!==n.indexOf("_link")){var l=n.slice(0,-5);l in(i=this.model.get("social_icons"))&&(i[l].link=s[n]),this.model.unset(n,{silent:!0})}if(-1!==n.indexOf("_type")){var d=n.slice(0,-5);d in(i=this.model.get("social_icons"))&&(i[d].type="native"===s[n]?"native":"click"),this.model.unset(n,{silent:!0})}},serviceTypeUpdated:function(t){var i=this.$("#wpmudev-sshare-counter-options"),s=e(".wph-wizard-services-icons-native"),n=e(".wph-wizard-services-icons-custom");"native"===t?(i.removeClass("wpmudev-hidden"),n.addClass("wpmudev-hidden"),s.removeClass("wpmudev-hidden")):(i.addClass("wpmudev-hidden"),s.addClass("wpmudev-hidden"),n.removeClass("wpmudev-hidden"))},clickCounterUpdated:function(t){var i=e("#wpmudev-sshare-counter-options .hustle-twitter-notice");"native"===t?i.removeClass("wpmudev-hidden"):i.hasClass("wpmudev-hidden")||i.addClass("wpmudev-hidden"),e("#wph-wizard-services-icons-native .wpmudev-social-item").each(function(){var i=e(this).find(".toggle-checkbox").is(":checked"),s=e(this).find("input.wpmudev-input_number");"none"!==t&&i?s.removeClass("wpmudev-hidden"):s.hasClass("wpmudev-hidden")||s.addClass("wpmudev-hidden")}),e("#wph-wizard-services-icons-native #wpmudev-counter-title>strong").removeClass("wpmudev-hidden"),"none"===t?e("#wph-wizard-services-icons-native #wpmudev-counter-title>strong:first-child").addClass("wpmudev-hidden"):e("#wph-wizard-services-icons-native #wpmudev-counter-title>strong:nth-child(2)").addClass("wpmudev-hidden")},toggleCheckbox:function(e){var t=this.$(e.target).closest("li"),i=t.find("input"),s=i.data("attribute");e.preventDefault(),e.stopPropagation(),t.hasClass("current")||(t.addClass("current"),t.siblings().removeClass("current"),this.model.set(s,i.val()))},toggleIcon:function(e){var t=this.$(e.target),i=t.is(":checked"),s="none"!==this.model.get("click_counter"),n=t.closest(".wpmudev-social-item"),a=n.find("input.wpmudev-input_number"),o=!(!i||!s);i?n.removeClass("disabled"):n.addClass("disabled"),0<t.parents(".wpmudev-social-native").length&&(o?a.removeClass("wpmudev-hidden"):a.addClass("wpmudev-hidden"))},setSocialIcons:function(){var e=this.model.toJSON();e=this.getSocialIconsData(e),this.model.set("social_icons",e.social_icons,{silent:!0})},getSocialIconsData:function(t){var i=e("#wph-wizard-services-icons-"+t.service_type+" .wpmudev-social-item"),s={};return i.each(function(){var t=e(this),i=t.find("input.toggle-checkbox"),n=i.data("id"),a=t.find("input.wpmudev-input_number"),o=t.find("input.wpmudev-input_text");a.length&&(0>parseInt(a.val())&&a.val(0));i.is(":checked")&&(s[n]={enabled:!0,counter:a.length?a.val():"0",link:o.length?o.val():""})}),i.length&&(t.social_icons=s),t}}))}),Hustle.define("SShare.Design_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),Hustle.get("Mixins.Module_Design"),{beforeRender:function(){Hustle.Events.off("modules.view.displayTypeUpdated",e.proxy(this.viewChangedDisplayTab,this)),Hustle.Events.on("modules.view.displayTypeUpdated",e.proxy(this.viewChangedDisplayTab,this)),Hustle.Events.off("modules.view.counterEnabledUpdated").on("modules.view.counterEnabledUpdated",e.proxy(this.counterEnabledUpdated,this))},afterRender:function(){this.targetContainer.length&&this.createPickers(),e('a[data-tab="appearance"]').on("click",e.proxy(this.updatePreview,this)),e('.sui-box[data-tab="display"] .sui-button[data-direction="next"').on("click",e.proxy(this.updatePreview,this)),e('.sui-box[data-tab="visibility"] .sui-button[data-direction="prev"').on("click",e.proxy(this.updatePreview,this)),this.updatePreview()},updatePreview:function(){e("#hui-preview-social-shares-floating").trigger("hustle_update_prewiev")},viewChanged:function(t){var i=t.changed,s=void 0!==Object.keys(i)[0]?Object.keys(i)[0]:"";if("flat"===t.get("icon_style")?(e("#hustle-floating-icons-custom-background").addClass("sui-hidden"),e("#hustle-widget-icons-custom-background").addClass("sui-hidden")):(e("#hustle-floating-icons-custom-background").removeClass("sui-hidden"),e("#hustle-widget-icons-custom-background").removeClass("sui-hidden")),"outline"===t.get("icon_style")?(e("#hustle-floating-icons-custom-background .sui-label").text("Icon border"),e("#hustle-widget-icons-custom-background .sui-label").text("Icon border"),e("#hustle-floating-counter-border").addClass("sui-hidden"),e("#hustle-widget-counter-border").addClass("sui-hidden")):(e("#hustle-floating-icons-custom-background .sui-label").text("Icon background"),e("#hustle-widget-icons-custom-background .sui-label").text("Icon background"),e("#hustle-floating-counter-border").removeClass("sui-hidden"),e("#hustle-widget-counter-border").removeClass("sui-hidden")),-1!==s.indexOf("_drop_shadow")){var n=s.slice(0,-12);this.toggleCheckbox("#hustle-"+n+"-shadow-toggle-wrapper",i[s])}if(-1!==s.indexOf("_customize_colors")){var a=s.slice(0,-17);this.toggleCheckbox("#hustle-"+a+"--customize-colors-toggle-wrapper",i[s]),console.log(t.get(a+"_customize_colors")),0===t.get(a+"_customize_colors")&&console.log("default"),1===t.get(a+"_customize_colors")&&console.log("custom")}this.updatePreview()},viewChangedDisplayTab:function(t){var i=t.get("inline_enabled"),s=t.get("widget_enabled"),n=t.get("shortcode_enabled"),a=t.get("float_desktop_enabled"),o=t.get("float_mobile_enabled"),l=_.intersection([1,"1","true"],[i,s,n]).length,d=_.intersection([1,"1","true"],[o,a]).length;d?(e("#hustle-appearance-floating-icons-row").show(),e("#hustle-appearance-floating-icons-placeholder").hide()):(e("#hustle-appearance-floating-icons-row").hide(),e("#hustle-appearance-floating-icons-placeholder").show()),l?(e("#hustle-appearance-widget-icons-row").show(),e("#hustle-appearance-widget-icons-placeholder").hide()):(e("#hustle-appearance-widget-icons-row").hide(),e("#hustle-appearance-widget-icons-placeholder").show()),l||d?(e("#hustle-appearance-icons-style").show(),e("#hustle-appearance-empty-message").hide()):(e("#hustle-appearance-icons-style").hide(),e("#hustle-appearance-empty-message").show(),e("#hustle-appearance-floating-icons-placeholder").hide(),e("#hustle-appearance-widget-icons-placeholder").hide())},toggleCheckbox:function(e,t){var i=this.$(e);i.length&&(t?i.removeClass("sui-hidden"):i.addClass("sui-hidden"))},counterEnabledUpdated:function(e){e.changed.counter_enabled?(this.$el.find("#hustle-floating-counter-colors").show(),this.$el.find("#hustle-widget-counter-colors").show()):(this.$el.find("#hustle-floating-counter-colors").hide(),this.$el.find("#hustle-widget-counter-colors").hide())}}))}),Hustle.define("SShare.Display_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Module_Display"),{moduleType:"social_sharing",extViewChanged:function(e){if(_.intersection(["float_desktop_enabled","float_mobile_enabled","inline_enabled","widget_enabled","shortcode_enabled"],Object.keys(e)).length){if(Hustle.Events.trigger("modules.view.displayTypeUpdated",this.model),"float_desktop_enabled"in e){var t=this.$("#hustle-float_desktop-toggle-wrapper");t.length&&(e.float_desktop_enabled?t.removeClass("sui-hidden"):t.addClass("sui-hidden"))}else if("float_mobile_enabled"in e){var i=this.$("#hustle-float_mobile-toggle-wrapper");i.length&&(e.float_mobile_enabled?i.removeClass("sui-hidden"):i.addClass("sui-hidden"))}}else"float_desktop_position"in e?"right"===e.float_desktop_position?(this.$("#hustle-float_desktop-left-offset-label").addClass("sui-hidden"),this.$("#hustle-float_desktop-right-offset-label").removeClass("sui-hidden"),this.$("#hustle-float_desktop-offset-x-wrapper").removeClass("sui-hidden")):"left"===e.float_desktop_position?(this.$("#hustle-float_desktop-left-offset-label").removeClass("sui-hidden"),this.$("#hustle-float_desktop-right-offset-label").addClass("sui-hidden"),this.$("#hustle-float_desktop-offset-x-wrapper").removeClass("sui-hidden")):this.$("#hustle-float_desktop-offset-x-wrapper").addClass("sui-hidden"):"float_desktop_position_y"in e?"bottom"===e.float_desktop_position_y?(this.$("#hustle-float_desktop-top-offset-label").addClass("sui-hidden"),this.$("#hustle-float_desktop-bottom-offset-label").removeClass("sui-hidden")):(this.$("#hustle-float_desktop-top-offset-label").removeClass("sui-hidden"),this.$("#hustle-float_desktop-bottom-offset-label").addClass("sui-hidden")):"float_mobile_position"in e?"right"===e.float_mobile_position?(this.$("#hustle-float_mobile-left-offset-label").addClass("sui-hidden"),this.$("#hustle-float_mobile-right-offset-label").removeClass("sui-hidden"),this.$("#hustle-float_mobile-offset-x-wrapper").removeClass("sui-hidden")):"left"===e.float_mobile_position?(this.$("#hustle-float_mobile-left-offset-label").removeClass("sui-hidden"),this.$("#hustle-float_mobile-right-offset-label").addClass("sui-hidden"),this.$("#hustle-float_mobile-offset-x-wrapper").removeClass("sui-hidden")):this.$("#hustle-float_mobile-offset-x-wrapper").addClass("sui-hidden"):"float_mobile_position_y"in e&&("bottom"===e.float_mobile_position_y?(this.$("#hustle-float_mobile-top-offset-label").addClass("sui-hidden"),this.$("#hustle-float_mobile-bottom-offset-label").removeClass("sui-hidden")):(this.$("#hustle-float_mobile-top-offset-label").removeClass("sui-hidden"),this.$("#hustle-float_mobile-bottom-offset-label").addClass("sui-hidden")))}}))}),Hustle.define("Modals.Services_Platforms",function(e){"use strict";return Backbone.View.extend({el:"#hustle-dialog--add-platforms",selectedPlatforms:[],events:{"click .sui-box-selector input":"selectPlatforms","click .hustle-cancel-platforms":"cancelPlatforms","click .sui-dialog-overlay":"cancelPlatforms","click #hustle-add-platforms":"addPlatforms"},initialize:function(e){this.selectedPlatforms=e,this.$(".hustle-add-platforms-option").prop("checked",!1).prop("disabled",!1);var t=!0,i=!1,s=void 0;try{for(var n,a=this.selectedPlatforms[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){var o=n.value;this.$("#hustle-social--"+o).prop("checked",!0).prop("disabled",!0)}}catch(e){i=!0,s=e}finally{try{t||null==a.return||a.return()}finally{if(i)throw s}}},selectPlatforms:function(e){var t=this.$(e.target),i=this.$el.find('label[for="'+t.attr("id")+'"]'),s=t.val();i.toggleClass("selected"),t.prop("checked")?this.selectedPlatforms.push(s):this.selectedPlatforms=_.without(this.selectedPlatforms,s)},cancelPlatforms:function(){SUI.dialogs["hustle-dialog--add-platforms"].hide()},addPlatforms:function(e){var t=this.$(e.target);t.addClass("sui-button-onload"),this.trigger("platforms:added",this.selectedPlatforms),setTimeout(function(){SUI.dialogs["hustle-dialog--add-platforms"].hide(),t.removeClass("sui-button-onload")},500)}})}),Hustle.define("SShare.View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Wizard_View"),{moduleType:"social_sharing",_events:{"hustle_update_prewiev #hui-preview-social-shares-floating":"updatePreview"},updatePreview:function(t){var i=_.extend({},this.model.toJSON(),this.getDataToSave());e.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"hustle_preview_module",id:this.model.get("module_id"),previewData:i},success:function(t){if(t.success){var i=e("#hui-preview-social-shares-floating"),s=e("#hui-preview-social-shares-widget");i.html(t.data.floatingHtml),s.html(t.data.widgetHtml),t.data.style&&i.append(t.data.style),e(".hustle-share-icon").on("click",function(e){return e.preventDefault()})}}})},setTabsViews:function(e){this.contentView=e.contentView,this.displayView=e.displayView,this.designView=e.designView,this.visibilityView=e.visibilityView},renderTabs:function(){this.contentView.targetContainer.html(""),this.contentView.render(),this.contentView.delegateEvents(),this.contentView.targetContainer.append(this.contentView.$el),this.contentView.afterRender(),this.designView.targetContainer.html(""),this.designView.delegateEvents(),this.designView.targetContainer.append(this.designView.$el),this.designView.afterRender(),this.displayView.targetContainer.html(""),this.displayView.render(),this.displayView.delegateEvents(),this.displayView.targetContainer.append(this.displayView.$el),this.displayView.afterRender(),this.visibilityView.delegateEvents(),this.visibilityView.targetContainer.append(this.visibilityView.$el),this.visibilityView.afterRender()},sanitizeData:function(){},getDataToSave:function(){return{content:this.contentView.model.toJSON(),display:this.displayView.model.toJSON(),design:this.designView.model.toJSON(),visibility:this.visibilityView.model.toJSON()}}}))}),Hustle.define("Popup.Module",function(){"use strict";"hustle_page_hustle_popup_listing"===pagenow&&new Optin.listingBase({moduleType:optinVars.current.module_type}),function(){if("hustle_page_hustle_popup"===pagenow){var e=Hustle.get("Models.Module_Defaults"),t=e.visibilityDefaults,i=e.settingsDefaults,s=Hustle.View.extend(Hustle.get("Mixins.Wizard_View")),n=Hustle.View.extend(Hustle.get("Mixins.Module_Content")),a=Hustle.View.extend(Hustle.get("Mixins.Module_Emails")),o=Hustle.View.extend(Hustle.get("Mixins.Module_Design")),l=Hustle.View.extend(Hustle.get("Mixins.Module_Visibility")),d=Hustle.View.extend(Hustle.get("Mixins.Module_Settings")),r=Hustle.get("Module.IntegrationsView"),u=Module.Model,c=Hustle.get("Models.M"),h=Hustle.get("Models.M"),p=Hustle.get("Models.M"),g=Hustle.get("Models.M"),m=Hustle.get("Models.M").extend({defaults:t.defaults,initialize:t.initialize}),f=Hustle.get("Models.M").extend({defaults:i.defaults,initialize:i.initialize}),_=new u(optinVars.current.data||{}),v=new c(optinVars.current.content||{}),b=new h(optinVars.current.emails||{}),w=new p(optinVars.current.design||{}),y=new g(optinVars.current.integrations||{}),x=new m(optinVars.current.visibility||{}),k=new f(optinVars.current.settings||{});new s({model:_,contentView:new n({model:v,moduleType:optinVars.current.data.module_type}),emailsView:new a({model:b}),designView:new o({model:w}),integrationsView:new r({model:y,moduleId:optinVars.current.data.module_id}),visibilityView:new l({model:x,moduleType:optinVars.current.data.module_type}),settingsView:new d({model:k})})}}()}),Hustle.define("Slidein.Module",function(){"use strict";"hustle_page_hustle_slidein_listing"===pagenow&&new Optin.listingBase({moduleType:optinVars.current.module_type}),function(){if("hustle_page_hustle_slidein"===pagenow){var e=Hustle.get("Models.Module_Defaults"),t=e.visibilityDefaults,i=e.settingsDefaults,s=Hustle.View.extend(Hustle.get("Mixins.Wizard_View")),n=Hustle.View.extend(Hustle.get("Mixins.Module_Content")),a=Hustle.View.extend(Hustle.get("Mixins.Module_Emails")),o=Hustle.View.extend(Hustle.get("Mixins.Module_Design")),l=Hustle.View.extend(Hustle.get("Mixins.Module_Visibility")),d=Hustle.View.extend(Hustle.get("Mixins.Module_Settings")),r=Hustle.get("Module.IntegrationsView"),u=Module.Model,c=Hustle.get("Models.M"),h=Hustle.get("Models.M"),p=Hustle.get("Models.M"),g=Hustle.get("Models.M"),m=Hustle.get("Models.M").extend({defaults:t.defaults,initialize:t.initialize}),f=Hustle.get("Models.M").extend({defaults:i.defaults,initialize:i.initialize}),_=new u(optinVars.current.data||{}),v=new c(optinVars.current.content||{}),b=new h(optinVars.current.emails||{}),w=new p(optinVars.current.design||{}),y=new g(optinVars.current.integrations||{}),x=new m(optinVars.current.visibility||{}),k=new f(optinVars.current.settings||{});new s({model:_,contentView:new n({model:v,moduleType:optinVars.current.data.module_type}),emailsView:new a({model:b}),designView:new o({model:w}),integrationsView:new r({model:y,moduleId:optinVars.current.data.module_id}),visibilityView:new l({model:x,moduleType:optinVars.current.data.module_type}),settingsView:new d({model:k})})}}()}),Hustle.define("Embedded.Module",function(){"use strict";"hustle_page_hustle_embedded_listing"===pagenow&&new Optin.listingBase({moduleType:optinVars.current.module_type}),function(){if("hustle_page_hustle_embedded"===pagenow){var e=Hustle.get("Models.Module_Defaults").visibilityDefaults,t=Hustle.View.extend(Hustle.get("Mixins.Wizard_View")),i=Hustle.View.extend(Hustle.get("Mixins.Module_Content")),s=Hustle.View.extend(Hustle.get("Mixins.Module_Emails")),n=Hustle.View.extend(Hustle.get("Mixins.Module_Design")),a=Hustle.View.extend(Hustle.get("Mixins.Module_Display")),o=Hustle.View.extend(Hustle.get("Mixins.Module_Visibility")),l=Hustle.View.extend(Hustle.get("Mixins.Module_Settings")),d=Hustle.get("Module.IntegrationsView"),r=Module.Model,u=Hustle.get("Models.M"),c=Hustle.get("Models.M"),h=Hustle.get("Models.M"),p=Hustle.get("Models.M"),g=Hustle.get("Models.M"),m=Hustle.get("Models.M").extend({defaults:e.defaults,initialize:e.initialize}),f=Hustle.get("Models.M"),_=new r(optinVars.current.data||{}),v=new u(optinVars.current.content||{}),b=new c(optinVars.current.emails||{}),w=new h(optinVars.current.design||{}),y=new p(optinVars.current.integrations||{}),x=new g(optinVars.current.display||{}),k=new m(optinVars.current.visibility||{}),C=new f(optinVars.current.settings||{});new t({model:_,contentView:new i({model:v,moduleType:optinVars.current.data.module_type}),emailsView:new s({model:b}),designView:new n({model:w}),integrationsView:new d({model:y,moduleId:optinVars.current.data.module_id}),displayView:new a({model:x,moduleType:optinVars.current.data.module_type}),visibilityView:new o({model:k,moduleType:optinVars.current.data.module_type}),settingsView:new l({model:C})})}}()}),Hustle.define("SShare.Module",function(e){"use strict";"hustle_page_hustle_sshare_listing"===pagenow&&new Optin.listingBase({moduleType:optinVars.current.module_type}),function(){if("hustle_page_hustle_sshare"===pagenow){var e=Hustle.get("Models.Module_Defaults").visibilityDefaults,t=Hustle.get("SShare.View"),i=Hustle.get("SShare.Content_View"),s=Hustle.get("SShare.Display_View"),n=Hustle.get("SShare.Design_View"),a=Hustle.View.extend(Hustle.get("Mixins.Module_Visibility")),o=Module.Model,l=Hustle.get("Models.M"),d=Hustle.get("Models.M"),r=Hustle.get("Models.M"),u=Hustle.get("Models.M").extend({defaults:e.defaults,initialize:e.initialize}),c=new o(optinVars.current.data||{}),h=new l(optinVars.current.content||{}),p=new d(optinVars.current.display||{}),g=new r(optinVars.current.design||{}),m=new u(optinVars.current.visibility||{});new t({model:c,contentView:new i({model:h,moduleType:optinVars.current.data.module_type}),displayView:new s({model:p}),designView:new n({model:g}),visibilityView:new a({model:m,moduleType:optinVars.current.data.module_type})})}}()}),Hustle.define("Dashboard.View",function(e,t,i){"use strict";"toplevel_page_hustle"===pagenow&&new(Backbone.View.extend({el:".sui-wrap",events:{"click .hustle-preview-module-button":"openPreview","click .hustle-delete-module-button":"openDeleteModal","click .hustle-toggle-status-module-button":"toggleModuleStatus","click .hustle-toggle-tracking-module-button":"toggleTracking","click #hustle-manage-tracking-types":"toggleTrackingTypes","click .hustle-manage-tracking-button":"openManageTrackingModal","click #hustle-dialog--tracking-reset-data .hustle-delete":"resetTrackingData","click .hustle-module-tracking-reset-button":"openResetTrackingModal","click .hustle-free-version-create":"showUpgradeModal","click .sui-dropdown .hustle-onload-icon-action":"addLoadingIconToActionsButton"},initialize:function(t){return e("#hustle-dialog--welcome").length&&this.openWelcomeDialog(),e("#hustle-dialog--migrate").length&&this.openMigrateDialog(),this.render()},render:function(){},openPreview:function(t){var i=e(t.currentTarget),s=i.data("id"),n=i.data("type");Module.preview.open(s,n)},toggleModuleStatus:function(t){var i=e(t.currentTarget),s=i.data("id"),n=i.data("nonce"),a=i.data("enabled"),o=i.data("type");e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_toggle_module_state",id:s,type:o,enabled:a,_ajax_nonce:n}}).done(function(e){if(e.success){i.data("enabled",1-a),i.find("span").toggleClass("sui-hidden");var t=i.parents("td.hui-status").find("span.sui-tooltip");t.removeClass("sui-draft sui-published"),a?t.addClass("sui-draft").attr("data-tooltip",optinVars.messages.commons.draft):t.addClass("sui-published").attr("data-tooltip",optinVars.messages.commons.published)}}).error(function(e){console.log(e)}).always(function(){e(".sui-button-onload").removeClass("sui-button-onload")})},toggleTracking:function(e){window.Hustle.moduleToggleModuleTracking(e)},toggleTrackingTypes:function(e){window.Hustle.moduleToggleModuleTrackingTypes(e)},showUpgradeModal:function(t){void 0!==t&&t.preventDefault(),e("#wph-upgrade-modal").addClass("wpmudev-modal-active")},openDeleteModal:function(t){t.preventDefault();var i=e(t.currentTarget),s={id:i.data("id"),nonce:i.data("nonce"),dialogType:i.data("type"),action:"delete"};Module.deleteModal.open(s)},resetTrackingData:function(e){Module.resetTrackingDataModal.reset(e)},openResetTrackingModal:function(t){t.preventDefault();var i=e(t.target),s={id:i.data("id"),nonce:i.data("nonce")};Module.resetTrackingDataModal.open(s)},addLoadingIconToActionsButton:function(t){e(t.currentTarget).closest(".sui-dropdown").find(".sui-dropdown-anchor").addClass("sui-button-onload")},openWelcomeDialog:function(){Hustle.get("Modals.Welcome")},openMigrateDialog:function(){Hustle.get("Modals.Migration")}}))}),Hustle.define("Integrations.View",function(e,t,i){"use strict";"hustle_page_hustle_integrations"===pagenow&&new(Backbone.View.extend({el:".sui-wrap",events:{"click .connect-integration":"connectIntegration","keypress .connect-integration":"preventEnterKeyFromDoingThings"},initialize:function(){this.stopListening(Hustle.Events,"hustle:providers:reload",this.renderProvidersTables),this.listenTo(Hustle.Events,"hustle:providers:reload",this.renderProvidersTables),this.render()},render:function(){var e=this.$el.find("#hustle-not-connected-providers-section"),t=this.$el.find("#hustle-connected-providers-section");0<e.length&&0<t.length&&this.renderProvidersTables(),optinVars.new_integration&&Module.Notification.open("success",optinVars.messages.commons.new_integration.replace(/{provider}/g,optinVars.new_integration),1e4)},renderProvidersTables:function(){var t=this,i={};this.$el.find(".hustle-integrations-display").html('<div class="sui-notice sui-notice-sm sui-notice-loading"><p>'+optinVars.fetching_list+"</p></div>"),i.action="hustle_provider_get_providers",i._ajax_nonce=optinVars.providers_action_nonce,i.data={},e.post({url:ajaxurl,type:"post",data:i}).done(function(e){e&&e.success&&(t.$el.find("#hustle-not-connected-providers-section").html(e.data.not_connected),t.$el.find("#hustle-connected-providers-section").html(e.data.connected))}).always(function(){t.$el.find(".sui-notice-loading").remove()})},preventEnterKeyFromDoingThings:function(e){13!==e.which||e.preventDefault()},connectIntegration:function(e){Module.integrationsModal.open(e)}}))}),Hustle.define("Entries.View",function(e,t,i){"use strict";"hustle_page_hustle_entries"===pagenow&&new(Backbone.View.extend({el:".sui-wrap",events:{"click .sui-pagination-wrap .hustle-open-inline-filter":"openFilterInline","click .sui-pagination-wrap .hustle-open-dialog-filter":"openFilterModal","click #hustle-dialog--filter-entries .hustle-dialog-close":"closeFilterModal","click .hustle-delete-entry-button":"openDeleteModal","click .sui-active-filter-remove":"removeFilter","click .hustle-entries-clear-filter":"clearFilter"},initialize:function(t){var i={};void 0!==window.hustle_entries_datepicker_ranges&&(i=window.hustle_entries_datepicker_ranges),e("input.hustle-entries-filter-date").daterangepicker({autoUpdateInput:!1,autoApply:!0,alwaysShowCalendars:!0,ranges:i,locale:optinVars.daterangepicker}),e("input.hustle-entries-filter-date").on("apply.daterangepicker",function(t,i){e(this).val(i.startDate.format("MM/DD/YYYY")+" - "+i.endDate.format("MM/DD/YYYY"))})},openFilterInline:function(e){var t=this.$(e.target),i=t.closest(".sui-pagination-wrap").find(".sui-button-icon"),s=t.closest(".hui-actions-bar").next(".sui-pagination-filter");i.toggleClass("sui-active"),s.toggleClass("sui-open"),e.preventDefault(),e.stopPropagation()},openFilterModal:function(e){SUI.dialogs["hustle-dialog--filter-entries"].show().on("show",function(e,t){e.getElementsByClassName("sui-dialog-content")[0].className="sui-dialog-content sui-fade-in"}),e.preventDefault()},closeFilterModal:function(e){SUI.dialogs["hustle-dialog--filter-entries"].hide(),SUI.dialogs["hustle-dialog--filter-entries"].on("hide",function(e,t){e.getElementsByClassName("sui-dialog-content")[0].className="sui-dialog-content sui-fade-out"}),e.preventDefault()},removeFilter:function(e){var t=this.$(e.target).data("filter"),i=new RegExp("&"+t+"=[^&]*","i");-1!==["order_by","search_email","date_range"].indexOf(t)&&(location.href=location.href.replace(i,""))},openDeleteModal:function(t){t.preventDefault();var i=e(t.target),s={id:i.data("id"),nonce:i.data("nonce"),dialogType:"",action:"delete"};Module.deleteModal.open(s)},clearFilter:function(e){e.preventDefault(),this.$("input[name=search_email]").val(""),this.$("input[name=date_range]").val("")}}))}),Hustle.define("Settings.View",function(e,t,i){"use strict";"hustle_page_hustle_settings"===pagenow&&new(Backbone.View.extend({el:".sui-wrap",events:{"click .sui-sidenav .sui-vertical-tab a":"sidenav","click .sui-pagination-wrap > button":"pagination","click #hustle-dialog-open--delete-ips":"ipsDialog",'change input[name="messages_enabled"]':"toggleBlock",'change input[name="email_enabled"]':"toggleBlock","click #hustle-delete-all-ips":"ipsDelete"},initialize:function(t){var s=Hustle.get("Settings.Dashboard_Analytics_View"),n=Hustle.get("Settings.Mail_View"),a=Hustle.get("Settings.reCaptcha_Settings"),o=Hustle.get("Settings.Accessibility_Settings"),l=Hustle.get("Settings.Permissions_View"),d=Hustle.get("Settings.Top_Metrics_View"),r=Hustle.get("Settings.Unsubscribe_View"),u=Hustle.get("Settings.Privacy_Settings");new s,new n,new a,new l,new d,new o,new r,new u,e(i).off("popstate",e.proxy(this.tabUpdate,this)),e(i).on("popstate",e.proxy(this.tabUpdate,this)),Hustle.Events.trigger("view.rendered",this)},toggleBlock:function(e){this.$(e.target).parent().siblings(".sui-toggle-content").toggleClass("sui-hidden")},sidenav:function(t){var i=e(t.target).data("tab");i&&this.tabJump(i,!0),t.preventDefault()},tabUpdate:function(e){var t=e.originalEvent.state;t&&this.tabJump(t.tabSelected)},tabJump:function(e,t){var i=this.$el.find('a[data-tab="'+e+'"]'),s=i.closest(".sui-vertical-tabs").find(".sui-vertical-tab"),n=this.$el.find(".sui-box[data-tab]"),a=this.$el.find('.sui-box[data-tab="'+e+'"]');t&&history.pushState({tabSelected:e},"Hustle Settings","admin.php?page=hustle_settings&section="+e),s.removeClass("current"),n.hide(),i.parent().addClass("current"),a.show()},pagination:function(e){var t=this.$(e.target).closest(".sui-pagination-wrap"),i=t.find(".sui-button-icon"),s=t.next(".sui-pagination-filter");i.toggleClass("sui-active"),s.toggleClass("sui-open"),e.preventDefault(),e.stopPropagation()},sidetabs:function(e){var t=this.$(e.target),i=t.parent("label"),s=t.data("tab-menu"),n=t.closest(".sui-side-tabs"),a=n.find(".sui-tabs-menu .sui-tab-item"),o=a.find("input");a.removeClass("active"),o.removeAttr("checked"),n.find(".sui-tabs-content > div").removeClass("active"),i.addClass("active"),t.attr("checked","checked"),n.find('.sui-tabs-content div[data-tab-content="'+s+'"]').length&&n.find('.sui-tabs-content div[data-tab-content="'+s+'"]').addClass("active")},ipsDialog:function(t){var i=this.$(t.target),s=e("#hustle-dialog--delete-ips"),n=s.find("#dialogTitle"),a=s.find("#dialogDescription");n.text(i.data("dialog-title")),a.text(i.data("dialog-info")),s.find("#hustle-delete-all-ips").data("notice",i.data("notice")),s.find("#hustle-delete-all-ips").data("range",i.data("range")),SUI.dialogs["hustle-dialog--delete-ips"].show(),t.preventDefault()},ipsDelete:function(t){var i=this.$(t.target),s=i.closest(".sui-dialog"),n=s.find("button, .sui-button"),a=i.data("range");"range"===a&&(a=e("#hustle-remove-specific-ips").val()),n.prop("disabled",!0),i.addClass("sui-button-onload"),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_remove_ips",range:a,_ajax_nonce:i.data("nonce")},success:function(){e("#"+i.data("notice")).show(),SUI.dialogs[s.attr("id")].hide(),i.removeClass("sui-button-onload"),n.prop("disabled",!1)},error:function(){SUI.dialogs[s.attr("id")].hide(),i.removeClass("sui-button-onload"),n.prop("disabled",!1),Module.Notification.open("error",optinVars.messages.something_went_wrong)}})}}))});